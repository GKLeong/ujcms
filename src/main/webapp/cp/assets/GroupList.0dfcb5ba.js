var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var E=(m,u,a)=>u in m?X(m,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[u]=a,B=(m,u)=>{for(var a in u||(u={}))x.call(u,a)&&E(m,a,u[a]);if(F)for(var a of F(u))ee.call(u,a)&&E(m,a,u[a]);return m},k=(m,u)=>Y(m,Z(u));import{g as M,I as p,j as v,o as A,k as N,w as s,l as e,q as O,C as le,F as ae,m as i,u as te,i as oe,M as se,N as ne,y as P,aq as ue,O as re,Q as ie,P as w,A as q,ap as de}from"./vendor.7e46e91a.js";import{m as C,o as me,w as pe,B as ce}from"./index.35346a57.js";import{A as fe,B as ve,C as be,D as Q,f as _e,E as ye}from"./user.72ed5abb.js";import{a as ge,b as $e,_ as L,c as Ve}from"./QueryItem.713a2356.js";import{_ as Ie}from"./ListMove.34265a1e.js";import{_ as Be}from"./DialogForm.5f4b290f.js";import{_ as we}from"./LabelTip.bc63985c.js";const qe={name:"GroupForm"},Ce=M(k(B({},qe),{props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(m){const u=p(),a=p({});return(d,r)=>{const b=v("el-input"),c=v("el-form-item"),V=v("el-switch"),g=v("el-option"),I=v("el-select");return A(),N(Be,{name:d.$t("menu.user.group"),queryBean:i(fe),createBean:i(ve),updateBean:i(be),deleteBean:i(Q),beanId:m.beanId,beanIds:m.beanIds,focus:u.value,initValues:()=>({type:2}),toValues:t=>B({},t),disableDelete:t=>t.id<=10,perms:"group",values:a.value,"onUpdate:values":r[4]||(r[4]=t=>a.value=t),"model-value":m.modelValue,"onUpdate:modelValue":r[5]||(r[5]=t=>d.$emit("update:modelValue",t)),onFinished:r[6]||(r[6]=t=>d.$emit("finished"))},{default:s(({})=>[e(c,{prop:"name",label:d.$t("group.name"),rules:{required:!0,message:()=>d.$t("v.required")}},{default:s(()=>[e(b,{modelValue:a.value.name,"onUpdate:modelValue":r[0]||(r[0]=t=>a.value.name=t),ref_key:"focus",ref:u,maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(c,{prop:"description",label:d.$t("group.description")},{default:s(()=>[e(b,{modelValue:a.value.description,"onUpdate:modelValue":r[1]||(r[1]=t=>a.value.description=t),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{prop:"allAccessPermission",rules:{required:!0,message:()=>d.$t("v.required")}},{label:s(()=>[e(we,{message:"group.allAccessPermission"})]),default:s(()=>[e(V,{modelValue:a.value.allAccessPermission,"onUpdate:modelValue":r[2]||(r[2]=t=>a.value.allAccessPermission=t)},null,8,["modelValue"])]),_:1},8,["rules"]),e(c,{prop:"type",label:d.$t("group.type"),rules:{required:!0,message:()=>d.$t("v.required")}},{default:s(()=>[e(I,{modelValue:a.value.type,"onUpdate:modelValue":r[3]||(r[3]=t=>a.value.type=t),disabled:a.value.type===1},{default:s(()=>[(A(),O(ae,null,le([1,2],t=>e(g,{key:t,disabled:t===1,label:d.$t(`group.type.${t}`),value:t},null,8,["disabled","label","value"])),64))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label","rules"])]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","focus","initValues","toValues","disableDelete","values","model-value"])}}})),ke={class:"mb-3"},Ae={class:"app-block mt-3"},De={name:"GroupList"},Me=M(k(B({},De),{setup(m){const{t:u}=te(),a=p({}),d=p(),r=p(),b=p([]),c=p([]),V=p(!1),g=p(!1),I=p(),t=oe(()=>b.value.map(l=>l.id)),G=p(!1),$=async()=>{V.value=!0;try{b.value=await _e(k(B({},me(a.value)),{Q_OrderBy:d.value})),G.value=Object.values(a.value).filter(l=>l!==void 0&&l!=="").length>0||d.value!==void 0}finally{V.value=!1}};se($);const z=({column:l,prop:n,order:f})=>{var _;n?d.value=((_=l.sortBy)!=null?_:n)+(f==="descending"?"_desc":""):d.value=void 0,$()},R=()=>$(),j=()=>{r.value.clearSort(),pe(a.value),d.value=void 0,$()},T=()=>{I.value=void 0,g.value=!0},S=l=>{I.value=l,g.value=!0},D=l=>l>10,U=async l=>{const n=l.filter(f=>D(f));n.length>0&&(await Q(n),$(),ie.success(u("success")))},H=async(l,n)=>{const f=ce(l,b.value,n);await ye(f.map(_=>_.id))};return(l,n)=>{const f=v("el-button"),_=v("el-popconfirm"),y=v("el-table-column"),J=v("el-tag"),K=v("el-table"),W=ne("loading");return A(),O("div",null,[P("div",ke,[e(i(ge),{params:a.value,onSearch:R,onReset:j},{default:s(()=>[e(i(L),{label:l.$t("group.name"),name:"Q_Contains_name"},null,8,["label"]),e(i(L),{label:l.$t("group.description"),name:"Q_Contains_description"},null,8,["label"])]),_:1},8,["params"])]),P("div",null,[e(f,{type:"primary",disabled:i(C)("group:create"),icon:i(ue),onClick:T},{default:s(()=>[w(q(l.$t("add")),1)]),_:1},8,["disabled","icon"]),e(_,{title:l.$t("confirmDelete"),onConfirm:n[0]||(n[0]=o=>U(c.value.map(h=>h.id)))},{reference:s(()=>[e(f,{disabled:c.value.filter(o=>D(o.id)).length<=0||i(C)("group:delete"),icon:i(de)},{default:s(()=>[w(q(l.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(Ie,{class:"ml-2",disabled:c.value.length<=0||G.value||i(C)("org:update"),onMove:n[1]||(n[1]=o=>H(c.value,o))},null,8,["disabled"]),e(i($e),{name:"group",class:"ml-2"})]),P("div",Ae,[re((A(),N(K,{ref_key:"table",ref:r,data:b.value,onSelectionChange:n[2]||(n[2]=o=>c.value=o),onRowDblclick:n[3]||(n[3]=o=>S(o.id)),onSortChange:z},{default:s(()=>[e(i(Ve),{name:"group"},{default:s(()=>[e(y,{type:"selection",width:"50"}),e(y,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(y,{property:"name",label:l.$t("group.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(y,{property:"description",label:l.$t("group.description"),"min-width":"150",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(y,{property:"allAccessPermission",label:l.$t("group.allAccessPermission"),sortable:"custom"},{default:s(({row:o})=>[e(J,{type:o.allAccessPermission?"success":"info",size:"small"},{default:s(()=>[w(q(l.$t(o.allAccessPermission?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(y,{property:"type",label:l.$t("group.type"),sortable:"custom","show-overflow-tooltip":"",formatter:o=>l.$t(`group.type.${o.type}`)},null,8,["label","formatter"]),e(y,{label:l.$t("table.action")},{default:s(({row:o})=>[e(f,{type:"primary",disabled:i(C)("group:update"),onClick:h=>S(o.id),size:"small",link:""},{default:s(()=>[w(q(l.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(_,{title:l.$t("confirmDelete"),onConfirm:h=>U([o.id])},{reference:s(()=>[e(f,{type:"primary",disabled:!D(o.id)||i(C)("group:delete"),size:"small",link:""},{default:s(()=>[w(q(l.$t("delete")),1)]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[W,V.value]])]),e(Ce,{modelValue:g.value,"onUpdate:modelValue":n[4]||(n[4]=o=>g.value=o),beanId:I.value,beanIds:i(t),onFinished:$},null,8,["modelValue","beanId","beanIds"])])}}}));export{Me as default};
