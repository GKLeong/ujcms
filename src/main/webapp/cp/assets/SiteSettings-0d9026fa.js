import{d as de,u as ne,r as p,X as H,cy as S,o as ie,a as n,b as me,c as i,e as v,w as a,h as e,I as g,a8 as b,a7 as _,f as pe,i as U,j as L,as as ve,l as fe,k as K,t as R,E as ge,R as be,S as _e,_ as Ve}from"./index-6c60ffba.js";import{t as ye}from"./tree-7e647485.js";import{H as we,q as ke,I as qe,J as ce,K as $e,L as Se,M as Ue}from"./config-d89d22f7.js";import{q as he}from"./user-602b45f1.js";import{_ as d}from"./LabelTip.vue_vue_type_script_setup_true_lang-b8070de6.js";import{a as N}from"./BaseUpload.vue_vue_type_style_index_0_scoped_5165bd65_lang-d72bc660.js";import{_ as Be}from"./FieldItem.vue_vue_type_script_setup_true_lang-caaba857.js";import"./content-6884eca6.js";import"./BaseUpload-3ff5bbd7.js";const Ie=k=>(be("data-v-7cc76eb1"),k=k(),_e(),k),Te={class:"watermark-position"},De=Ie(()=>L("span",null,null,-1)),Le={name:"SiteSettings"},Ce=de({...Le,emits:{"update:modelValue":null,finished:null},setup(k){const{t:F}=ne(),C=p(),V=p(),t=p({}),w=p(!1),h=p(!1),O=p([]),B=p([]),I=p([]),M=p(),J=H(()=>I.value.find(u=>u.id===M.value)),j=H(()=>{var u;return JSON.parse(((u=J.value)==null?void 0:u.customs)||"[]")}),y=[];S("siteSettings:base:update")&&y.push("base"),S("siteSettings:watermark:update")&&y.push("watermark"),S("siteSettings:messageBoard:update")&&y.push("messageBoard"),S("siteSettings:customs:update")&&y.push("customs");const m=p(y[0]),W=u=>{u==="watermark"?t.value=V.value.watermark:u==="messageBoard"?t.value=V.value.messageBoard:u==="customs"?t.value=V.value.customs:t.value=V.value},X=async()=>{B.value=await we()},A=async()=>{O.value=ye(await he())},G=async()=>{I.value=await ke({type:"site"})},P=async()=>{V.value=await qe(),M.value=V.value.modelId,W(m.value)};ie(async()=>{w.value=!0;try{await Promise.all([X(),A(),G(),P()])}finally{w.value=!1}});const Q=async()=>{w.value=!0;try{await P()}finally{w.value=!1}},Y=()=>{C.value.validate(async u=>{if(u){h.value=!0;try{m.value==="watermark"?await ce(t.value):m.value==="messageBoard"?await $e(t.value):m.value==="customs"?await Se(t.value):await Ue(t.value),ge.success(F("success"))}finally{h.value=!1}Q()}})};return(u,s)=>{const Z=n("el-tab-pane"),x=n("el-tabs"),ee=n("el-aside"),T=n("el-switch"),o=n("el-form-item"),r=n("el-col"),z=n("el-radio"),E=n("el-radio-group"),le=n("el-slider"),f=n("el-input"),q=n("el-row"),c=n("el-option"),$=n("el-select"),ae=n("el-input-number"),te=n("el-button"),se=n("el-form"),ue=n("el-main"),oe=n("el-container"),re=me("loading");return i(),v(oe,null,{default:a(()=>[e(ee,{width:"180px",class:"pr-3"},{default:a(()=>[e(x,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=l=>m.value=l),onTabClick:s[1]||(s[1]=({paneName:l})=>W(l)),"tab-position":"left",stretch:"",class:"bg-white"},{default:a(()=>[(i(),g(_,null,b(y,l=>e(Z,{key:l,name:l,label:u.$t(`site.settings.${l}`)},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(ue,{class:"p-3 app-block"},{default:a(()=>[pe((i(),v(se,{ref_key:"form",ref:C,model:t.value,"label-width":"150px"},{default:a(()=>[m.value==="watermark"?(i(),v(q,{key:0},{default:a(()=>[e(r,{span:24},{default:a(()=>[e(o,{prop:"enabled",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.watermark.enabled",help:""})]),default:a(()=>[e(T,{modelValue:t.value.enabled,"onUpdate:modelValue":s[2]||(s[2]=l=>t.value.enabled=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"overlay",label:u.$t("site.watermark.overlay"),rules:t.value.enabled?{required:!0,message:()=>u.$t("v.required")}:{}},{default:a(()=>[e(U(N),{modelValue:t.value.overlay,"onUpdate:modelValue":s[3]||(s[3]=l=>t.value.overlay=l)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"position",label:u.$t("site.watermark.position"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:a(()=>[e(E,{modelValue:t.value.position,"onUpdate:modelValue":s[4]||(s[4]=l=>t.value.position=l)},{default:a(()=>[L("div",Te,[(i(),g(_,null,b(9,l=>e(z,{key:l,label:l,title:u.$t(`site.watermark.position.${l}`)},{default:a(()=>[De]),_:2},1032,["label","title"])),64))])]),_:1},8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(o,{prop:"dissolve",label:u.$t("site.watermark.dissolve"),rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.watermark.dissolve",help:""})]),default:a(()=>[e(le,{modelValue:t.value.dissolve,"onUpdate:modelValue":s[5]||(s[5]=l=>t.value.dissolve=l),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"minWidth",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.watermark.minWidth",help:""})]),default:a(()=>[e(f,{modelValue:t.value.minWidth,"onUpdate:modelValue":s[6]||(s[6]=l=>t.value.minWidth=l),modelModifiers:{number:!0},min:1,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"minHeight",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.watermark.minHeight",help:""})]),default:a(()=>[e(f,{modelValue:t.value.minHeight,"onUpdate:modelValue":s[7]||(s[7]=l=>t.value.minHeight=l),modelModifiers:{number:!0},min:1,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})):m.value==="messageBoard"?(i(),v(q,{key:1},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(o,{prop:"enabled",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.messageBoard.enabled"})]),default:a(()=>[e(T,{modelValue:t.value.enabled,"onUpdate:modelValue":s[8]||(s[8]=l=>t.value.enabled=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"loginRequired",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.messageBoard.loginRequired"})]),default:a(()=>[e(T,{modelValue:t.value.loginRequired,"onUpdate:modelValue":s[9]||(s[9]=l=>t.value.loginRequired=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})):m.value==="customs"?(i(),v(q,{key:2},{default:a(()=>[(i(!0),g(_,null,b(U(j),l=>(i(),v(r,{key:l.code,span:l.double?12:24},{default:a(()=>[e(o,{prop:l.code,rules:l.required?{required:!0,message:()=>u.$t("v.required")}:void 0},{label:a(()=>[e(d,{label:l.name},null,8,["label"])]),default:a(()=>[e(Be,{field:l,modelValue:t.value[l.code],"onUpdate:modelValue":D=>t.value[l.code]=D,"model-key":t.value[l.code+"_key"],"onUpdate:model-key":D=>t.value[l.code+"_key"]=D},null,8,["field","modelValue","onUpdate:modelValue","model-key","onUpdate:model-key"])]),_:2},1032,["prop","rules"])]),_:2},1032,["span"]))),128))]),_:1})):(i(),v(q,{key:3},{default:a(()=>[e(r,{span:12},{default:a(()=>[e(o,{prop:"name",label:u.$t("site.name"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:a(()=>[e(f,{modelValue:t.value.name,"onUpdate:modelValue":s[10]||(s[10]=l=>t.value.name=l),ref:"focus",maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"protocol",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.protocol",help:""})]),default:a(()=>[e($,{modelValue:t.value.protocol,"onUpdate:modelValue":s[11]||(s[11]=l=>t.value.protocol=l),class:"w-full"},{default:a(()=>[(i(),g(_,null,b(["http","https"],l=>e(c,{key:l,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"domain",rules:[{required:!0,message:()=>u.$t("v.required")},{pattern:/^[a-z0-9-.]*$/,message:()=>u.$t("site.error.domainPattern")},{pattern:/^(?!(uploads|templates|WEB-INF|cp)$).*/i,message:()=>u.$t("site.error.excludesPattern")}]},{label:a(()=>[e(d,{message:"site.domain",help:""})]),default:a(()=>[e(f,{modelValue:t.value.domain,"onUpdate:modelValue":s[12]||(s[12]=l=>t.value.domain=l),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"subDir",rules:[{pattern:/^[\w-]*$/,message:()=>u.$t("site.error.subDirPattern")},{pattern:/^(?!(uploads|templates|WEB-INF|cp)$).*/i,message:()=>u.$t("site.error.excludesPattern")}]},{label:a(()=>[e(d,{message:"site.subDir",help:""})]),default:a(()=>[e(f,{modelValue:t.value.subDir,"onUpdate:modelValue":s[13]||(s[13]=l=>t.value.subDir=l),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"theme",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.theme",help:""})]),default:a(()=>[e($,{modelValue:t.value.theme,"onUpdate:modelValue":s[14]||(s[14]=l=>t.value.theme=l),class:"w-full"},{default:a(()=>[(i(!0),g(_,null,b(B.value,l=>(i(),v(c,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"mobileTheme",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.mobileTheme",help:""})]),default:a(()=>[e($,{modelValue:t.value.mobileTheme,"onUpdate:modelValue":s[15]||(s[15]=l=>t.value.mobileTheme=l),class:"w-full"},{default:a(()=>[(i(!0),g(_,null,b(B.value,l=>(i(),v(c,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"modelId",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.model",help:""})]),default:a(()=>[e($,{modelValue:t.value.modelId,"onUpdate:modelValue":s[16]||(s[16]=l=>t.value.modelId=l),class:"w-full"},{default:a(()=>[(i(!0),g(_,null,b(I.value,l=>(i(),v(c,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(o,{prop:"logo"},{label:a(()=>[e(d,{message:"site.logo",help:""})]),default:a(()=>[e(U(N),{modelValue:t.value.logo,"onUpdate:modelValue":s[17]||(s[17]=l=>t.value.logo=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"seoTitle"},{label:a(()=>[e(d,{message:"site.seoTitle",help:""})]),default:a(()=>[e(f,{modelValue:t.value.seoTitle,"onUpdate:modelValue":s[18]||(s[18]=l=>t.value.seoTitle=l),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"seoKeywords"},{label:a(()=>[e(d,{message:"site.seoKeywords",help:""})]),default:a(()=>[e(f,{modelValue:t.value.seoKeywords,"onUpdate:modelValue":s[19]||(s[19]=l=>t.value.seoKeywords=l),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:24},{default:a(()=>[e(o,{prop:"seoDescription"},{label:a(()=>[e(d,{message:"site.seoDescription",help:""})]),default:a(()=>[e(f,{modelValue:t.value.seoDescription,"onUpdate:modelValue":s[20]||(s[20]=l=>t.value.seoDescription=l),type:"textarea",rows:3,maxlength:"1000"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"pageSize",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(d,{message:"site.pageSize",help:""})]),default:a(()=>[e(ae,{modelValue:t.value.pageSize,"onUpdate:modelValue":s[21]||(s[21]=l=>t.value.pageSize=l),min:1,max:200},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:a(()=>[e(o,{prop:"status"},{label:a(()=>[e(d,{message:"site.status",help:""})]),default:a(()=>[e(E,{modelValue:t.value.status,"onUpdate:modelValue":s[22]||(s[22]=l=>t.value.status=l)},{default:a(()=>[(i(),g(_,null,b([0,1],l=>e(z,{key:l,label:l},{default:a(()=>[K(R(u.$t(`site.status.${l}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})),L("div",null,[e(te,{disabled:U(ve)(`siteSettings:${m.value}:update`),loading:h.value,onClick:fe(Y,["prevent"]),type:"primary","native-type":"submit"},{default:a(()=>[K(R(u.$t("save")),1)]),_:1},8,["disabled","loading","onClick"])])]),_:1},8,["model"])),[[re,w.value]])]),_:1})]),_:1})}}});const Fe=Ve(Ce,[["__scopeId","data-v-7cc76eb1"]]);export{Fe as default};
