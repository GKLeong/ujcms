import{d as M,u as O,U as p,V as $,r as b,o as P,a as C,c as d,I as r,h as t,w as s,j as e,t as a,i as m,W as q,X as z,J as B,Y as H,Z as S,k as c,$ as g,a0 as I}from"./index-0b297134.js";import{d as L,q as A,a as R,b as E}from"./stat-f2e5dc4d.js";const N={class:"p-3 app-block"},W={class:"text-sm text-gray-secondary"},U={class:"flex items-end justify-between mt-1"},F={class:"text-3xl text-primary"},G={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},J={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},X={class:"p-3 app-block"},Z={class:"text-sm text-gray-secondary"},K={class:"flex items-end justify-between mt-1"},Q={class:"text-3xl text-primary"},tt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},et={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},st={class:"p-3 app-block"},at={class:"text-sm text-gray-secondary"},nt={class:"flex items-end justify-between mt-1"},ot={class:"text-3xl text-primary"},lt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},it={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},ut={class:"p-3 app-block"},dt={class:"text-sm text-gray-secondary"},rt={class:"flex items-end justify-between mt-1"},ct={class:"text-3xl text-primary"},vt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},_t={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},ft={class:"px-3 py-5 mt-3 app-block"},pt={class:"flex p-3 mt-3 justify-evenly app-block"},yt={class:"h-64 w-60 text-primary"},ht={class:"mt-2 text-center"},mt={class:"flex items-center justify-center mt-2"},xt={class:"text-3xl"},gt={key:0},bt={key:1},Ct={class:"mt-4 space-y-2 text-sm"},wt={key:0},kt={key:1},$t={key:0},St={key:1},Vt={key:0},jt={key:1},Yt={class:"h-64 w-60 text-gray-secondary"},Dt={class:"mt-2 text-center"},Tt={class:"flex items-center justify-center mt-2"},Mt={class:"text-3xl"},Ot={key:0},Pt={key:1},qt={class:"mt-4 space-y-2 text-sm"},zt={key:0},Bt={key:1},Ht={key:0},It={key:1},Lt={key:0},At={key:1},Rt={class:"p-3 mt-3 app-block"},Ut=M({__name:"HomePage",setup(Et){const{t:x,n:V}=O();p.extend(L);const w=$(),j=async()=>{const o=await A({begin:p().startOf("day").subtract(1,"day").format(),end:p().endOf("day").format()}),h={tooltip:{trigger:"axis"},legend:{data:[x("visitTrend.yesterdayPv"),x("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:x("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:o.filter(l=>p(l.date)<p().startOf("day")).map(l=>l.pvCount)},{name:x("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:o.filter(l=>p(l.date)>=p().startOf("day")).map(l=>l.pvCount)}]},v=w.value;if(v==null)return;let n=g.getInstanceByDom(v);n==null&&(n=g.init(v)),n.setOption(h),window.addEventListener("resize",function(){n&&n.resize()})},k=$(),Y=async()=>{const o=await R({begin:p().subtract(30,"day").format("YYYY-MM-DD"),end:p().format("YYYY-MM-DD")}),h={title:{text:x("menu.stat.visitSource"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},tooltip:{trigger:"item",valueFormatter:l=>V(l)},series:[{name:x("menu.stat.visitSource"),type:"pie",radius:["44%","80%"],center:["40%","54%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1}},labelLine:{show:!1},data:o.map(l=>({value:l.pvCount,name:x(`visitSource.type.${l.name}`)}))}]},v=k.value;if(v==null)return;let n=g.getInstanceByDom(v);n==null&&(n=g.init(v)),n.setOption(h),window.addEventListener("resize",function(){n&&n.resize()})},i=b({}),u=b({}),D=async()=>{const o=await E({begin:p().subtract(30,"day").format("YYYY-MM-DD"),end:p().format("YYYY-MM-DD")});i.value=o.newVisitor,u.value=o.oldVisitor;const h=i.value.uvCount+u.value.uvCount;h>0?(i.value.proportion=i.value.uvCount*100/h,u.value.proportion=u.value.uvCount*100/h):(i.value.proportion=50,u.value.proportion=50)},y=b({}),T=async()=>{y.value=await I()};return P(async()=>{j(),Y(),D(),T()}),(o,h)=>{const v=C("el-icon"),n=C("el-col"),l=C("el-row");return d(),r("div",null,[t(l,{gutter:12},{default:s(()=>[t(n,{span:6},{default:s(()=>{var _,f;return[e("div",N,[e("div",W,a(o.$t("contentStat.article")),1),e("div",U,[e("div",F,a((_=y.value.article)==null?void 0:_.total),1),e("div",G,[t(v,null,{default:s(()=>[t(m(q))]),_:1})])]),e("div",J,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((f=y.value.article)==null?void 0:f.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var _,f;return[e("div",X,[e("div",Z,a(o.$t("contentStat.channel")),1),e("div",K,[e("div",Q,a((_=y.value.channel)==null?void 0:_.total),1),e("div",tt,[t(v,null,{default:s(()=>[t(m(z))]),_:1})])]),e("div",et,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((f=y.value.channel)==null?void 0:f.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var _,f;return[e("div",st,[e("div",at,a(o.$t("contentStat.user")),1),e("div",nt,[e("div",ot,a((_=y.value.user)==null?void 0:_.total),1),e("div",lt,[t(v,null,{default:s(()=>[t(m(B))]),_:1})])]),e("div",it,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((f=y.value.user)==null?void 0:f.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var _,f;return[e("div",ut,[e("div",dt,a(o.$t("contentStat.attachment")),1),e("div",rt,[e("div",ct,a((_=y.value.attachment)==null?void 0:_.total),1),e("div",vt,[t(v,null,{default:s(()=>[t(m(H))]),_:1})])]),e("div",_t,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((f=y.value.attachment)==null?void 0:f.last7day),1)])])]}),_:1})]),_:1}),e("div",ft,[e("div",{ref_key:"trendChart",ref:w,class:"h-64"},null,512)]),t(l,{gutter:12},{default:s(()=>[t(n,{span:12},{default:s(()=>{var _,f;return[e("div",pt,[e("div",yt,[e("div",ht,a(o.$t("visitVisitor.newVisitor")),1),e("div",mt,[t(v,{class:"text-5xl"},{default:s(()=>[t(m(S))]),_:1}),e("span",xt,[i.value.uvCount>0?(d(),r("span",gt,a(o.$n((_=i.value.proportion)!=null?_:0,"decimal")),1)):(d(),r("span",bt,"-")),c("% ")])]),e("div",Ct,[t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visitVisitor.pv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[c(a(i.value.pvCount),1)]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visitVisitor.uv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[c(a(i.value.uvCount),1)]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.bounceRate")),1)]),_:1}),t(n,{span:12},{default:s(()=>[i.value.uvCount>0?(d(),r("span",wt,a(o.$n(i.value.bounceCount*100/i.value.uvCount,"decimal"))+"%",1)):(d(),r("span",kt,"-"))]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.averageDuration")),1)]),_:1}),t(n,{span:12},{default:s(()=>[i.value.uvCount>0?(d(),r("span",$t,a(m(p).duration(i.value.duration/i.value.uvCount,"seconds").format("HH:mm:ss")),1)):(d(),r("span",St,"-"))]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.averagePv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[i.value.uvCount>0?(d(),r("span",Vt,a(o.$n(i.value.pvCount/i.value.uvCount,"decimal")),1)):(d(),r("span",jt,"-"))]),_:1})]),_:1})])]),e("div",Yt,[e("div",Dt,a(o.$t("visitVisitor.oldVisitor")),1),e("div",Tt,[t(v,{class:"text-5xl"},{default:s(()=>[t(m(S))]),_:1}),e("span",Mt,[u.value.uvCount>0?(d(),r("span",Ot,a(o.$n((f=u.value.proportion)!=null?f:0,"decimal")),1)):(d(),r("span",Pt,"-")),c("% ")])]),e("div",qt,[t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visitVisitor.pv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[c(a(u.value.pvCount),1)]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visitVisitor.uv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[c(a(u.value.uvCount),1)]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.bounceRate")),1)]),_:1}),t(n,{span:12},{default:s(()=>[u.value.uvCount>0?(d(),r("span",zt,a(o.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(d(),r("span",Bt,"-"))]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.averageDuration")),1)]),_:1}),t(n,{span:12},{default:s(()=>[u.value.uvCount>0?(d(),r("span",Ht,a(m(p).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(d(),r("span",It,"-"))]),_:1})]),_:1}),t(l,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[c(a(o.$t("visit.averagePv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[u.value.uvCount>0?(d(),r("span",Lt,a(o.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(d(),r("span",At,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(n,{span:12},{default:s(()=>[e("div",Rt,[e("div",{ref_key:"sourceTypeChart",ref:k,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{Ut as default};
