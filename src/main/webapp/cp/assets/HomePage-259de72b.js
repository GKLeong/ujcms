import{d as U,u as N,U as m,V as M,r as w,o as E,b,e as r,I as f,i as t,w as s,f as j,k as e,j as h,W as V,l as o,t as a,h as Y,X as W,Y as F,J as G,Z as J,$ as A,a0 as C,a1 as X,a2 as T}from"./index-8830bcc4.js";import{d as Z}from"./duration-40733dfa.js";import{q as K,a as Q,b as tt}from"./stat-478fd2f6.js";import{q as et,a as st}from"./content-8945637b.js";import{q as at}from"./interaction-57dcbd41.js";const nt={class:"mb-3 shadow-md bg-warning-lighter"},lt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},ot={class:"flex items-center"},it={class:"mb-3 shadow-md bg-warning-lighter"},rt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},ut={class:"flex items-center"},dt={class:"mb-3 shadow-md bg-warning-lighter"},ct={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},vt={class:"flex items-center"},ft={class:"p-3 app-block"},pt={class:"text-sm text-gray-secondary"},_t={class:"flex items-end justify-between mt-1"},yt={class:"text-3xl text-primary"},mt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},ht={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},gt={class:"p-3 app-block"},xt={class:"text-sm text-gray-secondary"},wt={class:"flex items-end justify-between mt-1"},bt={class:"text-3xl text-primary"},Ct={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},kt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},$t={class:"p-3 app-block"},St={class:"text-sm text-gray-secondary"},jt={class:"flex items-end justify-between mt-1"},Vt={class:"text-3xl text-primary"},Yt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},Dt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},qt={class:"p-3 app-block"},Mt={class:"text-sm text-gray-secondary"},At={class:"flex items-end justify-between mt-1"},Tt={class:"text-3xl text-primary"},Bt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},Pt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Rt={class:"px-3 py-5 mt-3 app-block"},Ot={class:"flex p-3 mt-3 justify-evenly app-block"},zt={class:"h-64 w-60 text-primary"},Ht={class:"mt-2 text-center"},It={class:"flex items-center justify-center mt-2"},Lt={class:"text-3xl"},Ut={key:0},Nt={key:1},Et={class:"mt-4 space-y-2 text-sm"},Wt={key:0},Ft={key:1},Gt={key:0},Jt={key:1},Xt={key:0},Zt={key:1},Kt={class:"h-64 w-60 text-gray-secondary"},Qt={class:"mt-2 text-center"},te={class:"flex items-center justify-center mt-2"},ee={class:"text-3xl"},se={key:0},ae={key:1},ne={class:"mt-4 space-y-2 text-sm"},le={key:0},oe={key:1},ie={key:0},re={key:1},ue={key:0},de={key:1},ce={class:"p-3 mt-3 app-block"},he=U({__name:"HomePage",setup(ve){const{t:x,n:B}=N();m.extend(Z);const D=M(),P=async()=>{const n=await K({begin:m().startOf("day").subtract(1,"day").format(),end:m().endOf("day").format()}),i={tooltip:{trigger:"axis"},legend:{data:[x("visitTrend.yesterdayPv"),x("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:x("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:n.filter(l=>m(l.date)<m().startOf("day")).map(l=>l.pvCount)},{name:x("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:n.filter(l=>m(l.date)>=m().startOf("day")).map(l=>l.pvCount)}]},v=D.value;if(v==null)return;let c=C.getInstanceByDom(v);c==null&&(c=C.init(v)),c.setOption(i),window.addEventListener("resize",function(){c&&c.resize()})},q=M(),R=async()=>{const n=await Q({begin:m().subtract(30,"day").format("YYYY-MM-DD"),end:m().format("YYYY-MM-DD")}),i={title:{text:x("menu.stat.visitSource"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},tooltip:{trigger:"item",valueFormatter:l=>B(l)},series:[{name:x("menu.stat.visitSource"),type:"pie",radius:["44%","80%"],center:["40%","54%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1}},labelLine:{show:!1},data:n.map(l=>({value:l.pvCount,name:x(`visitSource.type.${l.name}`)}))}]},v=q.value;if(v==null)return;let c=C.getInstanceByDom(v);c==null&&(c=C.init(v)),c.setOption(i),window.addEventListener("resize",function(){c&&c.resize()})},u=w({}),d=w({}),O=async()=>{const n=await tt({begin:m().subtract(30,"day").format("YYYY-MM-DD"),end:m().format("YYYY-MM-DD")});u.value=n.newVisitor,d.value=n.oldVisitor;const i=u.value.uvCount+d.value.uvCount;i>0?(u.value.proportion=u.value.uvCount*100/i,d.value.proportion=d.value.uvCount*100/i):(u.value.proportion=50,d.value.proportion=50)},g=w({}),z=async()=>{g.value=await X()},k=w(0),H=async()=>{T.epRank>=1&&(k.value=await et())},$=w(0),I=async()=>{T.epRank>=1&&($.value=await st())},S=w(0),L=async()=>{S.value=await at()};return E(async()=>{H(),I(),L(),P(),R(),O(),z()}),(n,i)=>{const v=b("el-icon"),c=b("el-link"),l=b("el-col"),y=b("el-row");return r(),f("div",null,[t(y,{gutter:12},{default:s(()=>[k.value>0?(r(),j(l,{key:0,span:6},{default:s(()=>[e("div",nt,[e("div",lt,[e("div",ot,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[0]||(i[0]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[o(a(n.$t("todo.pendingArticle")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[1]||(i[1]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[o(a(k.value),1)]),_:1})])])])]),_:1})):Y("",!0),$.value>0?(r(),j(l,{key:1,span:6},{default:s(()=>[e("div",it,[e("div",rt,[e("div",ut,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[2]||(i[2]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[o(a(n.$t("todo.rejectedArticle")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[3]||(i[3]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[o(a($.value),1)]),_:1})])])])]),_:1})):Y("",!0),S.value>0?(r(),j(l,{key:2,span:6},{default:s(()=>[e("div",dt,[e("div",ct,[e("div",vt,[t(v,null,{default:s(()=>[t(h(V))]),_:1}),t(c,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:i[4]||(i[4]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[o(a(n.$t("todo.unreviewedMessageBoard")),1)]),_:1})]),e("div",null,[t(c,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:i[5]||(i[5]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[o(a(S.value),1)]),_:1})])])])]),_:1})):Y("",!0)]),_:1}),t(y,{gutter:12},{default:s(()=>[t(l,{span:6},{default:s(()=>{var p,_;return[e("div",ft,[e("div",pt,a(n.$t("contentStat.article")),1),e("div",_t,[e("div",yt,a((p=g.value.article)==null?void 0:p.total),1),e("div",mt,[t(v,null,{default:s(()=>[t(h(W))]),_:1})])]),e("div",ht,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.article)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",gt,[e("div",xt,a(n.$t("contentStat.channel")),1),e("div",wt,[e("div",bt,a((p=g.value.channel)==null?void 0:p.total),1),e("div",Ct,[t(v,null,{default:s(()=>[t(h(F))]),_:1})])]),e("div",kt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.channel)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",$t,[e("div",St,a(n.$t("contentStat.user")),1),e("div",jt,[e("div",Vt,a((p=g.value.user)==null?void 0:p.total),1),e("div",Yt,[t(v,null,{default:s(()=>[t(h(G))]),_:1})])]),e("div",Dt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.user)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",qt,[e("div",Mt,a(n.$t("contentStat.attachment")),1),e("div",At,[e("div",Tt,a((p=g.value.attachment)==null?void 0:p.total),1),e("div",Bt,[t(v,null,{default:s(()=>[t(h(J))]),_:1})])]),e("div",Pt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.attachment)==null?void 0:_.last7day),1)])])]}),_:1})]),_:1}),e("div",Rt,[e("div",{ref_key:"trendChart",ref:D,class:"h-64"},null,512)]),t(y,{gutter:12},{default:s(()=>[t(l,{span:12},{default:s(()=>{var p,_;return[e("div",Ot,[e("div",zt,[e("div",Ht,a(n.$t("visitVisitor.newVisitor")),1),e("div",It,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(A))]),_:1}),e("span",Lt,[u.value.uvCount>0?(r(),f("span",Ut,a(n.$n((p=u.value.proportion)!=null?p:0,"decimal")),1)):(r(),f("span",Nt,"-")),o("% ")])]),e("div",Et,[t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(u.value.pvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(u.value.uvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Wt,a(n.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(r(),f("span",Ft,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Gt,a(h(m).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),f("span",Jt,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),f("span",Xt,a(n.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(r(),f("span",Zt,"-"))]),_:1})]),_:1})])]),e("div",Kt,[e("div",Qt,a(n.$t("visitVisitor.oldVisitor")),1),e("div",te,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(A))]),_:1}),e("span",ee,[d.value.uvCount>0?(r(),f("span",se,a(n.$n((_=d.value.proportion)!=null?_:0,"decimal")),1)):(r(),f("span",ae,"-")),o("% ")])]),e("div",ne,[t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(d.value.pvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[o(a(d.value.uvCount),1)]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",le,a(n.$n(d.value.bounceCount*100/d.value.uvCount,"decimal"))+"%",1)):(r(),f("span",oe,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",ie,a(h(m).duration(d.value.duration/d.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),f("span",re,"-"))]),_:1})]),_:1}),t(y,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[o(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),f("span",ue,a(n.$n(d.value.pvCount/d.value.uvCount,"decimal")),1)):(r(),f("span",de,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(l,{span:12},{default:s(()=>[e("div",ce,[e("div",{ref_key:"sourceTypeChart",ref:q,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{he as default};
