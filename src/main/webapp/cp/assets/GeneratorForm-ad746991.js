import{d as G,r as y,a as v,c as b,e as _,w as a,h as e,g as $,k as f,t as i,j as w,i as r,u as X,X as le,o as J,b as K,I as Q,as as C,a1 as te,f as Z,W as O,aG as se,aH as ne,aD as ue,aI as oe,E as q,l as R,cx as de,a7 as re,a8 as ie}from"./index-6c60ffba.js";import{k as pe,u as me}from"./config-d89d22f7.js";import{L as fe,M as ve,N as W,O as ce,P as be,Q as ye}from"./content-6884eca6.js";import{_ as L}from"./LabelTip.vue_vue_type_script_setup_true_lang-b8070de6.js";import{c as _e,e as ge,u as ke,f as x,g as $e}from"./system-4c24cbad.js";import{a as he,_ as Ve,b as we,c as De}from"./QueryItem.vue_vue_type_script_setup_true_lang-b16aac13.js";import{_ as Ce}from"./DialogForm.vue_vue_type_script_setup_true_lang-e536e4f0.js";const Se={class:"whitespace-pre-wrap"},Ie={name:"TaskForm"},qe=G({...Ie,props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(T){const l=y({});return(p,t)=>{const g=v("el-input"),n=v("el-form-item"),c=v("el-col"),U=v("el-date-picker"),M=v("el-option"),z=v("el-select"),D=v("el-tag"),B=v("el-row");return b(),_(Ce,{name:p.$t("menu.system.task"),queryBean:r(_e),createBean:r(ge),updateBean:r(ke),deleteBean:r(x),beanId:T.beanId,beanIds:T.beanIds,initValues:()=>({user:{}}),toValues:o=>({...o}),disableEdit:()=>!0,addable:!1,perms:"task",values:l.value,"onUpdate:values":t[7]||(t[7]=o=>l.value=o),"model-value":T.modelValue,"onUpdate:modelValue":t[8]||(t[8]=o=>p.$emit("update:modelValue",o)),onFinished:t[9]||(t[9]=o=>p.$emit("finished")),large:""},{default:a(({})=>[e(B,null,{default:a(()=>[e(c,{span:12},{default:a(()=>[e(n,{prop:"name",label:p.$t("task.name")},{default:a(()=>[e(g,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.name=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"user.username",label:p.$t("task.user")},{default:a(()=>[e(g,{modelValue:l.value.user.username,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.user.username=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"beginDate",label:p.$t("task.beginDate")},{default:a(()=>[e(U,{modelValue:l.value.beginDate,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.beginDate=o),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"endDate",label:p.$t("task.endDate")},{default:a(()=>[e(U,{modelValue:l.value.endDate,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.endDate=o),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"current",label:p.$t("task.current")},{default:a(()=>[e(g,{modelValue:l.value.current,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.current=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"processedIn",label:p.$t("task.processedIn")},{default:a(()=>[e(g,{modelValue:l.value.processedIn,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.processedIn=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{prop:"type",label:p.$t("task.type")},{default:a(()=>[l.value.type?(b(),_(z,{key:0,modelValue:l.value.type,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.type=o)},{default:a(()=>[e(M,{value:l.value.type,label:p.$t(`task.type.${l.value.type}`)},null,8,["value","label"])]),_:1},8,["modelValue"])):$("",!0)]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(n,{label:p.$t("task.status")},{default:a(()=>[l.value.status===0?(b(),_(D,{key:0,type:"info"},{default:a(()=>[f(i(p.$t(`task.status.${l.value.status}`)),1)]),_:1})):$("",!0),l.value.status===1?(b(),_(D,{key:1},{default:a(()=>[f(i(p.$t(`task.status.${l.value.status}`)),1)]),_:1})):$("",!0),l.value.status===2?(b(),_(D,{key:2,type:"danger"},{default:a(()=>[f(i(p.$t(`task.status.${l.value.status}`)),1)]),_:1})):$("",!0),l.value.status===3?(b(),_(D,{key:3,type:"warning"},{default:a(()=>[f(i(p.$t(`task.status.${l.value.status}`)),1)]),_:1})):$("",!0),l.value.status===4?(b(),_(D,{key:4,type:"success"},{default:a(()=>[f(i(p.$t(`task.status.${l.value.status}`)),1)]),_:1})):$("",!0)]),_:1},8,["label"])]),_:1}),l.value.errorInfo?(b(),_(c,{key:0,span:24},{default:a(()=>[e(n,{label:p.$t("task.errorInfo")},{default:a(()=>[w("pre",null,[w("code",Se,i(l.value.errorInfo),1)])]),_:1},8,["label"])]),_:1})):$("",!0)]),_:1})]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","initValues","toValues","disableEdit","values","model-value"])}}}),Ue={class:"mb-3"},ze={class:"app-block mt-3"},Be={name:"TaskList"},He=G({...Be,setup(T,{expose:l}){const{t:p}=X(),t=y({}),g=y(),n=y(1),c=y(10),U=y(0),M=y(),z=y([]),D=y([]),B=y(!1),o=y(!1),F=y(),N=le(()=>z.value.map(s=>s.id)),d=async()=>{B.value=!0;try{const{content:s,totalElements:m}=await $e({...ue(t.value),Q_OrderBy:g.value,page:n.value,pageSize:c.value});z.value=s,U.value=m}finally{B.value=!1}};J(d);const h=({column:s,prop:m,order:H})=>{var P;m?g.value=((P=s.sortBy)!=null?P:m)+(H==="descending"?"_desc":""):g.value=void 0,d()},S=()=>d(),I=()=>{M.value.clearSort(),oe(t.value),g.value=void 0,d()},Y=s=>{F.value=s,o.value=!0},E=async s=>{await x(s),d(),q.success(p("success"))};return l({fetchData:d}),(s,m)=>{const H=v("el-button"),P=v("el-popconfirm"),V=v("el-table-column"),A=v("el-tag"),k=v("el-table"),ee=v("el-pagination"),ae=K("loading");return b(),Q("div",null,[w("div",Ue,[e(r(Ve),{params:t.value,onSearch:S,onReset:I},{default:a(()=>[e(r(he),{label:s.$t("task.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),w("div",null,[e(P,{title:s.$t("confirmDelete"),onConfirm:m[0]||(m[0]=u=>E(D.value.map(j=>j.id)))},{reference:a(()=>[e(H,{disabled:D.value.length<=0||r(C)("task:delete"),icon:r(te)},{default:a(()=>[f(i(s.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(r(we),{name:"task",class:"ml-2"})]),w("div",ze,[Z((b(),_(k,{ref_key:"table",ref:M,data:z.value,onSelectionChange:m[1]||(m[1]=u=>D.value=u),onRowDblclick:m[2]||(m[2]=u=>Y(u.id)),onSortChange:h},{default:a(()=>[e(r(De),{name:"task"},{default:a(()=>[e(V,{type:"selection",width:"45"}),e(V,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(V,{property:"name",label:s.$t("task.name"),sortable:"custom","min-width":"150","show-overflow-tooltip":""},null,8,["label"]),e(V,{property:"beginDate",label:s.$t("task.beginDate"),sortable:"custom",width:"170"},{default:a(({row:u})=>[f(i(r(O)(u.beginDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(V,{property:"endDate",label:s.$t("task.endDate"),sortable:"custom",width:"170",display:"none"},{default:a(({row:u})=>[f(i(r(O)(u.endDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(V,{property:"current",label:s.$t("task.current"),"min-width":"70",align:"right"},null,8,["label"]),e(V,{property:"processedIn",label:s.$t("task.processedIn"),"min-width":"70",align:"right"},null,8,["label"]),e(V,{property:"user.username",label:s.$t("task.user"),"sort-by":"user-username",sortable:"custom","min-width":"80",align:"right"},null,8,["label"]),e(V,{property:"status",label:s.$t("task.status"),sortable:"custom",width:"80","show-overflow-tooltip":""},{default:a(({row:u})=>[u.status===0?(b(),_(A,{key:0,type:"info",size:"small"},{default:a(()=>[f(i(s.$t(`task.status.${u.status}`)),1)]),_:2},1024)):$("",!0),u.status===1?(b(),_(A,{key:1,size:"small"},{default:a(()=>[f(i(s.$t(`task.status.${u.status}`)),1)]),_:2},1024)):$("",!0),u.status===2?(b(),_(A,{key:2,type:"danger",size:"small"},{default:a(()=>[f(i(s.$t(`task.status.${u.status}`)),1)]),_:2},1024)):$("",!0),u.status===3?(b(),_(A,{key:3,type:"warning",size:"small"},{default:a(()=>[f(i(s.$t(`task.status.${u.status}`)),1)]),_:2},1024)):$("",!0),u.status===4?(b(),_(A,{key:4,type:"success",size:"small"},{default:a(()=>[f(i(s.$t(`task.status.${u.status}`)),1)]),_:2},1024)):$("",!0)]),_:1},8,["label"]),e(V,{label:s.$t("table.action")},{default:a(({row:u})=>[e(H,{type:"primary",disabled:r(C)("task:show"),onClick:j=>Y(u.id),size:"small",link:""},{default:a(()=>[f(i(s.$t("detail")),1)]),_:2},1032,["disabled","onClick"]),e(P,{title:s.$t("confirmDelete"),onConfirm:j=>E([u.id])},{reference:a(()=>[e(H,{type:"primary",disabled:r(C)("task:delete"),size:"small",link:""},{default:a(()=>[f(i(s.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ae,B.value]]),e(ee,{currentPage:n.value,"onUpdate:currentPage":m[3]||(m[3]=u=>n.value=u),pageSize:c.value,"onUpdate:pageSize":m[4]||(m[4]=u=>c.value=u),total:U.value,"page-sizes":r(se),layout:r(ne),onSizeChange:m[5]||(m[5]=u=>d()),onCurrentChange:m[6]||(m[6]=u=>d()),small:"",background:"",class:"px-3 py-2 justify-end"},null,8,["currentPage","pageSize","total","page-sizes","layout"])]),e(qe,{modelValue:o.value,"onUpdate:modelValue":m[7]||(m[7]=u=>o.value=u),beanId:F.value,beanIds:r(N),onFinished:d},null,8,["modelValue","beanId","beanIds"])])}}}),Pe={class:"p-3 app-block"},Ae=w("span",{class:"mx-2"},"|",-1),Re={class:"mt-3 p-3 app-block"},Le={class:"pb-2 border-b text-gray-primary"},Me={class:"mt-3 p-3 app-block"},Te={class:"text-gray-primary"},Ye={name:"GeneratorForm"},We=G({...Ye,setup(T){const{t:l}=X(),p=y(),t=y({}),g=y(!1),n=y(!1),c=y(),U=async()=>{t.value=await pe()};J(async()=>{g.value=!0;try{await U()}finally{g.value=!1}});const M=async()=>{n.value=!0;try{await fe(),await c.value.fetchData(),q.success(l("success"))}finally{n.value=!1}},z=async()=>{n.value=!0;try{await ve(),await c.value.fetchData(),q.success(l("success"))}finally{n.value=!1}},D=async()=>{n.value=!0;try{await W(),await c.value.fetchData(),q.success(l("success"))}finally{n.value=!1}},B=async()=>{n.value=!0;try{await ce(),q.success(l("success"))}finally{n.value=!1}},o=async()=>{n.value=!0;try{await be(),await c.value.fetchData(),q.success(l("success"))}finally{n.value=!1}},F=async()=>{n.value=!0;try{await ye(),await c.value.fetchData(),q.success(l("success"))}finally{n.value=!1}},N=()=>{p.value&&p.value.validate(async d=>{if(d){g.value=!0;try{await me(t.value),await W(),await c.value.fetchData(),q.success(l("success"))}finally{g.value=!1}}})};return(d,h)=>{const S=v("el-button"),I=v("el-form-item"),Y=v("el-form"),E=v("el-switch"),s=v("el-col"),m=v("el-input"),H=v("el-option"),P=v("el-select"),V=v("el-row"),A=K("loading");return b(),Q("div",null,[w("div",Pe,[e(Y,{"label-width":"200px"},{default:a(()=>[e(I,null,{label:a(()=>[e(L,{message:"generator.fulltext",help:""})]),default:a(()=>[e(S,{disabled:r(C)("generator:fulltext:reindexAll"),loading:n.value,onClick:R(M,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.fulltext.reindexAll")),1)]),_:1},8,["disabled","loading","onClick"]),r(de)("generator:fulltext:reindexSite")?(b(),_(S,{key:0,disabled:r(C)("generator:fulltext:reindexSite"),loading:n.value,onClick:R(z,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.fulltext.reindexSite")),1)]),_:1},8,["disabled","loading","onClick"])):$("",!0)]),_:1}),e(I,null,{label:a(()=>[e(L,{message:"generator.html",help:""})]),default:a(()=>[e(S,{disabled:r(C)("generator:html"),loading:n.value,onClick:R(D,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.html.all")),1)]),_:1},8,["disabled","loading","onClick"]),Ae,e(S,{disabled:r(C)("generator:html"),loading:n.value,onClick:R(B,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.html.home")),1)]),_:1},8,["disabled","loading","onClick"]),e(S,{disabled:r(C)("generator:html"),loading:n.value,onClick:R(o,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.html.channel")),1)]),_:1},8,["disabled","loading","onClick"]),e(S,{disabled:r(C)("generator:html"),loading:n.value,onClick:R(F,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(i(d.$t("generator.op.html.article")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),w("div",Re,[w("div",Le,i(d.$t("site.settings.html")),1),Z((b(),_(Y,{class:"mt-3",ref_key:"form",ref:p,model:t.value,disabled:r(C)("siteSettings:html:update"),"label-width":"200px"},{default:a(()=>[e(V,null,{default:a(()=>[e(s,{span:12},{default:a(()=>[e(I,{prop:"enabled",rules:{required:!0,message:()=>d.$t("v.required")}},{label:a(()=>[e(L,{message:"site.html.enabled",help:""})]),default:a(()=>[e(E,{modelValue:t.value.enabled,"onUpdate:modelValue":h[0]||(h[0]=k=>t.value.enabled=k)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"auto",rules:{required:!0,message:()=>d.$t("v.required")}},{label:a(()=>[e(L,{message:"site.html.auto",help:""})]),default:a(()=>[e(E,{modelValue:t.value.auto,"onUpdate:modelValue":h[1]||(h[1]=k=>t.value.auto=k)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"channel",rules:{required:!0,message:()=>d.$t("v.required")}},{label:a(()=>[e(L,{message:"site.html.channel",help:""})]),default:a(()=>[e(m,{modelValue:t.value.channel,"onUpdate:modelValue":h[2]||(h[2]=k=>t.value.channel=k),maxlength:"100"},{append:a(()=>[f(".html")]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"article",rules:{required:!0,message:()=>d.$t("v.required")}},{label:a(()=>[e(L,{message:"site.html.article",help:""})]),default:a(()=>[e(m,{modelValue:t.value.article,"onUpdate:modelValue":h[3]||(h[3]=k=>t.value.article=k),maxlength:"100"},{append:a(()=>[f(".html")]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"listPages",rules:{required:!0,message:()=>d.$t("v.required")}},{label:a(()=>[e(L,{message:"site.html.listPages",help:""})]),default:a(()=>[e(P,{modelValue:t.value.listPages,"onUpdate:modelValue":h[4]||(h[4]=k=>t.value.listPages=k),placeholder:"Select"},{default:a(()=>[(b(),Q(re,null,ie([{label:"1",value:1},{label:"3",value:3},{label:"10",value:10},{label:"100",value:100},{label:"1000",value:1e3},{label:"全部",value:2147483647}],k=>e(H,{key:k.value,label:k.label,value:k.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1}),w("div",null,[e(S,{disabled:r(C)("siteSettings:html:update"),onClick:R(N,["prevent"]),type:"primary","native-type":"submit"},{default:a(()=>[f(i(d.$t("submit")),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["model","disabled"])),[[A,g.value]])]),w("div",Me,[w("div",Te,i(d.$t("generator.taskList")),1)]),e(He,{ref_key:"taskListRef",ref:c,class:"mt-3"},null,512)])}}});export{We as default};
