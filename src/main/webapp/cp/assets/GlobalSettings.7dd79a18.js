var ae=Object.defineProperty,ue=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var P=(v,m,g)=>m in v?ae(v,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):v[m]=g,I=(v,m)=>{for(var g in m||(m={}))oe.call(m,g)&&P(v,g,m[g]);if(K)for(var g of K(m))se.call(m,g)&&P(v,g,m[g]);return v},H=(v,m)=>ue(v,te(m));import{g as re,u as ne,I as y,i as de,M as ie,j as i,N as me,o as f,k as b,w as l,l as e,q as w,C as T,F as h,O as pe,m as c,x as ge,y as fe,P as ve,A as Ve,K as ye,Q as be}from"./vendor.3651bf9f.js";import{t as _e}from"./tree.4a0f1dfa.js";import{f as ce}from"./system.6c199ff9.js";import{h as qe,b as Ue,j as Se,k as $e,l as we,m as he,n as ke,o as Le,p as Te,r as xe,s as Ce}from"./config.d674241a.js";import{_ as Me,o as q,c as k,p as De}from"./index.53bc5a6e.js";import{_ as n}from"./LabelTip.06c71e40.js";import{_ as Ke}from"./FieldItem.c5e3c5bd.js";import"./content.773ecdb4.js";import"./ImageListUpload.vue_vue_type_style_index_0_scoped_true_lang.ebc555fa.js";const Pe={name:"GlobalSettings"},Ie=re(H(I({},Pe),{setup(v){const{t:m}=ne(),g=y(),S=y({}),u=y({}),U=y(!1),L=y(!1),x=y([]),C=y(),B=de(()=>{var o;return JSON.parse(((o=C.value)==null?void 0:o.customs)||"[]")}),V=[];q("config:base:update")&&V.push("base"),q("config:upload:update")&&V.push("upload"),q("config:uploadStorage:update")&&V.push("uploadStorage"),q("config:htmlStorage:update")&&V.push("htmlStorage"),q("config:templateStorage:update")&&V.push("templateStorage"),q("config:customs:update")&&V.push("customs");const p=y(V[0]),M=async o=>{o==="upload"?u.value=S.value.upload:o==="uploadStorage"?u.value=await Se():o==="htmlStorage"?u.value=await $e():o==="templateStorage"?u.value=await we():o==="customs"?u.value=S.value.customs:u.value=S.value},W=async()=>{C.value=await qe()},D=async()=>{S.value=await Ue(),M(p.value)},G=async()=>{x.value=_e(await ce())};ie(async()=>{U.value=!0;try{await Promise.all([D(),W(),G()])}finally{U.value=!1}});const j=async()=>{U.value=!0;try{await D()}finally{U.value=!1}},E=()=>{g.value.validate(async o=>{if(!!o){L.value=!0;try{p.value==="upload"?await he(u.value):p.value==="customs"?await ke(u.value):p.value==="uploadStorage"?await Le(u.value):p.value==="htmlStorage"?await Te(u.value):p.value==="templateStorage"?await xe(u.value):await Ce(u.value),be.success(m("success"))}finally{L.value=!1}j()}})};return(o,t)=>{const F=i("el-tab-pane"),N=i("el-tabs"),O=i("el-aside"),d=i("el-input"),s=i("el-form-item"),r=i("el-col"),_=i("el-input-number"),$=i("el-row"),R=i("el-option"),A=i("el-select"),J=i("el-cascader"),Q=i("el-switch"),z=i("el-button"),X=i("el-form"),Y=i("el-main"),Z=i("el-container"),ee=me("loading");return f(),b(Z,null,{default:l(()=>[e(O,{width:"180px",class:"pr-3"},{default:l(()=>[e(N,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=a=>p.value=a),onTabClick:t[1]||(t[1]=({paneName:a})=>M(a)),"tab-position":"left",stretch:"",class:"bg-white"},{default:l(()=>[(f(),w(h,null,T(V,a=>e(F,{key:a,name:a,label:o.$t(`config.settings.${a}`)},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"p-3 app-block"},{default:l(()=>[pe((f(),b(X,{ref_key:"form",ref:g,model:u.value,"label-width":"150px"},{default:l(()=>[p.value==="upload"?(f(),b($,{key:0},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(s,{prop:"imageTypes",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.imageTypes",help:""})]),default:l(()=>[e(d,{modelValue:u.value.imageTypes,"onUpdate:modelValue":t[2]||(t[2]=a=>u.value.imageTypes=a),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"imageLimit",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.imageLimit",help:""})]),default:l(()=>[e(_,{modelValue:u.value.imageLimit,"onUpdate:modelValue":t[3]||(t[3]=a=>u.value.imageLimit=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"videoTypes",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.videoTypes",help:""})]),default:l(()=>[e(d,{modelValue:u.value.videoTypes,"onUpdate:modelValue":t[4]||(t[4]=a=>u.value.videoTypes=a),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"videoLimit",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.videoLimit",help:""})]),default:l(()=>[e(_,{modelValue:u.value.videoLimit,"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.videoLimit=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"libraryTypes",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.libraryTypes",help:""})]),default:l(()=>[e(d,{modelValue:u.value.libraryTypes,"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.libraryTypes=a),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"libraryLimit",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.libraryLimit",help:""})]),default:l(()=>[e(_,{modelValue:u.value.libraryLimit,"onUpdate:modelValue":t[7]||(t[7]=a=>u.value.libraryLimit=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"docTypes",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.docTypes",help:""})]),default:l(()=>[e(d,{modelValue:u.value.docTypes,"onUpdate:modelValue":t[8]||(t[8]=a=>u.value.docTypes=a),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"docLimit",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.docLimit",help:""})]),default:l(()=>[e(_,{modelValue:u.value.docLimit,"onUpdate:modelValue":t[9]||(t[9]=a=>u.value.docLimit=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"fileTypes",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.fileTypes",help:""})]),default:l(()=>[e(d,{modelValue:u.value.fileTypes,"onUpdate:modelValue":t[10]||(t[10]=a=>u.value.fileTypes=a),maxlength:"255"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"fileLimit",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.fileLimit",help:""})]),default:l(()=>[e(_,{modelValue:u.value.fileLimit,"onUpdate:modelValue":t[11]||(t[11]=a=>u.value.fileLimit=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"imageMaxWidth",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.imageMaxWidth",help:""})]),default:l(()=>[e(_,{modelValue:u.value.imageMaxWidth,"onUpdate:modelValue":t[12]||(t[12]=a=>u.value.imageMaxWidth=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"imageMaxHeight",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.upload.imageMaxHeight",help:""})]),default:l(()=>[e(_,{modelValue:u.value.imageMaxHeight,"onUpdate:modelValue":t[13]||(t[13]=a=>u.value.imageMaxHeight=a),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})):p.value==="uploadStorage"||p.value==="htmlStorage"||p.value==="templateStorage"?(f(),b($,{key:1},{default:l(()=>[e(r,{span:24},{default:l(()=>[e(s,{prop:"type",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.type"})]),default:l(()=>[e(A,{modelValue:u.value.type,"onUpdate:modelValue":t[14]||(t[14]=a=>u.value.type=a),class:"w-full"},{default:l(()=>[(f(!0),w(h,null,T([0,1].filter(a=>a!==1||c(k).epRank>0||c(k).epDisplay),a=>(f(),b(R,{disabled:c(k).epRank<=0&&c(k).epDisplay,key:a,value:a,label:o.$t(`config.storage.type.${a}`)},null,8,["disabled","value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:l(()=>[e(s,{prop:"path",rules:{pattern:/^(?!.*\.\.).*$/,message:()=>o.$t("v.url")}},{label:l(()=>[e(n,{message:"config.storage.path"})]),default:l(()=>[e(d,{modelValue:u.value.path,"onUpdate:modelValue":t[15]||(t[15]=a=>u.value.path=a),maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:l(()=>[e(s,{prop:"url",rules:{pattern:/^(?!.*\.\.).*$/,message:()=>o.$t("v.url")}},{label:l(()=>[e(n,{message:"config.storage.url"})]),default:l(()=>[e(d,{modelValue:u.value.url,"onUpdate:modelValue":t[16]||(t[16]=a=>u.value.url=a),maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),u.value.type===1?(f(),w(h,{key:0},[e(r,{span:24},{default:l(()=>[e(s,{prop:"endpoint",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.endpoint"})]),default:l(()=>[e(d,{modelValue:u.value.endpoint,"onUpdate:modelValue":t[17]||(t[17]=a=>u.value.endpoint=a),maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"region",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.region"})]),default:l(()=>[e(d,{modelValue:u.value.region,"onUpdate:modelValue":t[18]||(t[18]=a=>u.value.region=a),maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"bucket",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.bucket"})]),default:l(()=>[e(d,{modelValue:u.value.bucket,"onUpdate:modelValue":t[19]||(t[19]=a=>u.value.bucket=a),maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:l(()=>[e(s,{prop:"accessKey",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.accessKey"})]),default:l(()=>[e(d,{modelValue:u.value.accessKey,"onUpdate:modelValue":t[20]||(t[20]=a=>u.value.accessKey=a),type:"password","show-password":"",maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:l(()=>[e(s,{prop:"secretKey",rules:{required:!0,message:()=>o.$t("v.required")}},{label:l(()=>[e(n,{message:"config.storage.secretKey"})]),default:l(()=>[e(d,{modelValue:u.value.secretKey,"onUpdate:modelValue":t[21]||(t[21]=a=>u.value.secretKey=a),type:"password","show-password":"",maxlength:"160"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})],64)):ge("",!0)]),_:1})):p.value==="customs"?(f(),b($,{key:2},{default:l(()=>[(f(!0),w(h,null,T(c(B),a=>(f(),b(r,{key:a.code,span:a.double?12:24},{default:l(()=>[e(s,{prop:a.code,label:a.name,rules:a.required?{required:!0,message:()=>o.$t("v.required")}:void 0},{default:l(()=>[e(Ke,{field:a,modelValue:u.value[a.code],"onUpdate:modelValue":le=>u.value[a.code]=le},null,8,["field","modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","label","rules"])]),_:2},1032,["span"]))),128))]),_:1})):(f(),b($,{key:3},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(s,{prop:"port",rules:{type:"number",min:0,max:65535,message:()=>o.$t("v.range",{min:0,max:65535})}},{label:l(()=>[e(n,{message:"config.port",help:""})]),default:l(()=>[e(d,{modelValue:u.value.port,"onUpdate:modelValue":t[22]||(t[22]=a=>u.value.port=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"contextPath"},{label:l(()=>[e(n,{message:"config.contextPath",help:""})]),default:l(()=>[e(d,{modelValue:u.value.contextPath,"onUpdate:modelValue":t[23]||(t[23]=a=>u.value.contextPath=a),maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"channelUrl",rules:{pattern:/^\/[\w-]+$/,message:()=>o.$t("config.error.channelUrlPattern")}},{label:l(()=>[e(n,{message:"config.channelUrl",help:""})]),default:l(()=>[e(d,{modelValue:u.value.channelUrl,"onUpdate:modelValue":t[24]||(t[24]=a=>u.value.channelUrl=a),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"articleUrl"},{label:l(()=>[e(n,{message:"config.articleUrl",help:""})]),default:l(()=>[e(d,{modelValue:u.value.articleUrl,"onUpdate:modelValue":t[25]||(t[25]=a=>u.value.articleUrl=a),maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"defaultSiteId",label:o.$t("config.defaultSite")},{default:l(()=>[e(J,{modelValue:u.value.defaultSiteId,"onUpdate:modelValue":t[26]||(t[26]=a=>u.value.defaultSiteId=a),options:x.value,props:{value:"id",label:"name",checkStrictly:!0},onChange:t[27]||(t[27]=a=>u.value.defaultSiteId=a==null?void 0:a[a.length-1]),class:"w-full"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1}),e(r,{span:12},{default:l(()=>[e(s,{prop:"multiDomain"},{label:l(()=>[e(n,{message:"config.multiDomain",help:""})]),default:l(()=>[e(Q,{modelValue:u.value.multiDomain,"onUpdate:modelValue":t[28]||(t[28]=a=>u.value.multiDomain=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})),fe("div",null,[e(z,{disabled:c(De)(`config:${p.value}:update`),loading:L.value,onClick:ye(E,["prevent"]),type:"primary","native-type":"submit"},{default:l(()=>[ve(Ve(o.$t("submit")),1)]),_:1},8,["disabled","loading","onClick"])])]),_:1},8,["model"])),[[ee,U.value]])]),_:1})]),_:1})}}}));var Ae=Me(Ie,[["__scopeId","data-v-38fbba38"]]);export{Ae as default};
