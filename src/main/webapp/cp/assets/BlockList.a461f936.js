var T=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var P=(b,m,a)=>m in b?T(b,m,{enumerable:!0,configurable:!0,writable:!0,value:a}):b[m]=a,C=(b,m)=>{for(var a in m||(m={}))Z.call(m,a)&&P(b,a,m[a]);if(O)for(var a of O(m))x.call(m,a)&&P(b,a,m[a]);return b},W=(b,m)=>X(b,Y(m));import{g as Q,I as q,j as $,o as g,k as y,w as l,l as e,m as n,q as z,C as ee,F as le,x as L,P as k,A as v,u as ae,i as te,M as oe,N as ue,y as A,ao as se,O as ie,Q as de,an as re}from"./vendor.8f1addd2.js";import{p as H,t as ne,r as me,k as pe}from"./index.36604f4c.js";import{F as be,G as fe,H as ve,I as ge,J as $e,K as j,a as ke,L as Ve}from"./config.a6042d71.js";import{a as ce,b as qe,_ as ye,c as Ie}from"./QueryItem.f45658c4.js";import{_ as we}from"./ListMove.491706f0.js";import{_ as he}from"./DialogForm.ed473c62.js";import{_ as _e}from"./LabelTip.9bcdedcd.js";const Ue={name:"BlockForm"},Re=Q(W(C({},Ue),{props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(b){const m=q(),a=q({});return(t,o)=>{const h=$("el-input"),d=$("el-form-item"),r=$("el-col"),D=$("el-radio"),M=$("el-radio-group"),f=$("el-switch"),_=$("el-input-number"),I=$("el-row");return g(),y(he,{name:t.$t("menu.config.block"),queryBean:n(ve),createBean:n(ge),updateBean:n($e),deleteBean:n(j),beanId:b.beanId,beanIds:b.beanIds,focus:m.value,initValues:()=>({scope:0,withLinkUrl:!0,linkUrlRequired:!0,withSubtitle:!1,subtitleRequired:!1,withDescription:!1,descriptionRequired:!1,withImage:!1,imageRequired:!1,imageWidth:300,imageHeight:200,withMobileImage:!1,mobileImageRequired:!1,mobileImageWidth:300,mobileImageHeight:200,enabled:!0,recommendable:!0}),toValues:V=>C({},V),perms:"block",values:a.value,"onUpdate:values":o[19]||(o[19]=V=>a.value=V),"model-value":b.modelValue,"onUpdate:modelValue":o[20]||(o[20]=V=>t.$emit("update:modelValue",V)),onFinished:o[21]||(o[21]=V=>t.$emit("finished"))},{default:l(({bean:V})=>[e(I,null,{default:l(()=>[e(r,{span:24},{default:l(()=>[e(d,{prop:"name",label:t.$t("block.name"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(h,{modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=u=>a.value.name=u),ref_key:"focus",ref:m,maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:24},{default:l(()=>[e(d,{prop:"alias",label:t.$t("block.alias"),rules:[{required:!0,message:()=>t.$t("v.required")},{asyncValidator:async(u,S,U)=>{S!==V.alias&&await n(be)(S,a.value.scope)&&U(t.$t("block.error.aliasExist")),U()}}]},{default:l(()=>[e(h,{modelValue:a.value.alias,"onUpdate:modelValue":o[1]||(o[1]=u=>a.value.alias=u),maxlength:"50"},null,8,["modelValue"])]),_:2},1032,["label","rules"])]),_:2},1024),e(r,{span:24},{default:l(()=>[e(d,{prop:"scope",label:t.$t("block.scope"),rules:[{required:!0,message:()=>t.$t("v.required")},{asyncValidator:async(u,S,U)=>{S!==V.scope&&await n(fe)(a.value.scope)&&U(t.$t("block.error.scopeNotAllowd")),U()}}]},{default:l(()=>[e(M,{modelValue:a.value.scope,"onUpdate:modelValue":o[2]||(o[2]=u=>a.value.scope=u)},{default:l(()=>[(g(),z(le,null,ee([0,2],u=>e(D,{key:u,label:u},{default:l(()=>[k(v(t.$t(`block.scope.${u}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:2},1032,["label","rules"])]),_:2},1024),e(r,{span:12},{default:l(()=>[e(d,{prop:"withLinkUrl",label:t.$t("block.withLinkUrl"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.withLinkUrl,"onUpdate:modelValue":o[3]||(o[3]=u=>a.value.withLinkUrl=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"linkUrlRequired",label:t.$t("block.linkUrlRequired"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.linkUrlRequired,"onUpdate:modelValue":o[4]||(o[4]=u=>a.value.linkUrlRequired=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"withSubtitle",label:t.$t("block.withSubtitle"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.withSubtitle,"onUpdate:modelValue":o[5]||(o[5]=u=>a.value.withSubtitle=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"subtitleRequired",label:t.$t("block.subtitleRequired"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.subtitleRequired,"onUpdate:modelValue":o[6]||(o[6]=u=>a.value.subtitleRequired=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"withDescription",label:t.$t("block.withDescription"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.withDescription,"onUpdate:modelValue":o[7]||(o[7]=u=>a.value.withDescription=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"descriptionRequired",label:t.$t("block.descriptionRequired"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.descriptionRequired,"onUpdate:modelValue":o[8]||(o[8]=u=>a.value.descriptionRequired=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"withImage",label:t.$t("block.withImage"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.withImage,"onUpdate:modelValue":o[9]||(o[9]=u=>a.value.withImage=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"imageRequired",label:t.$t("block.imageRequired"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.imageRequired,"onUpdate:modelValue":o[10]||(o[10]=u=>a.value.imageRequired=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),a.value.withImage?(g(),y(r,{key:0,span:12},{default:l(()=>[e(d,{prop:"imageWidth",label:t.$t("block.imageWidth"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(_,{modelValue:a.value.imageWidth,"onUpdate:modelValue":o[11]||(o[11]=u=>a.value.imageWidth=u),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})):L("",!0),a.value.withImage?(g(),y(r,{key:1,span:12},{default:l(()=>[e(d,{prop:"imageHeight",label:t.$t("block.imageHeight"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(_,{modelValue:a.value.imageHeight,"onUpdate:modelValue":o[12]||(o[12]=u=>a.value.imageHeight=u),min:0,max:65535},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})):L("",!0),e(r,{span:12},{default:l(()=>[e(d,{prop:"withMobileImage",label:t.$t("block.withMobileImage"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.withMobileImage,"onUpdate:modelValue":o[13]||(o[13]=u=>a.value.withMobileImage=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"mobileImageRequired",label:t.$t("block.mobileImageRequired"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.mobileImageRequired,"onUpdate:modelValue":o[14]||(o[14]=u=>a.value.mobileImageRequired=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),a.value.withMobileImage?(g(),y(r,{key:2,span:12},{default:l(()=>[e(d,{prop:"mobileImageWidth",label:t.$t("block.mobileImageWidth"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(_,{modelValue:a.value.mobileImageWidth,"onUpdate:modelValue":o[15]||(o[15]=u=>a.value.mobileImageWidth=u),min:16,max:65535},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})):L("",!0),a.value.withMobileImage?(g(),y(r,{key:3,span:12},{default:l(()=>[e(d,{prop:"mobileImageHeight",label:t.$t("block.mobileImageHeight"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(_,{modelValue:a.value.mobileImageHeight,"onUpdate:modelValue":o[16]||(o[16]=u=>a.value.mobileImageHeight=u),min:16,max:65535},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})):L("",!0),e(r,{span:12},{default:l(()=>[e(d,{prop:"enabled",label:t.$t("block.enabled"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:l(()=>[e(f,{modelValue:a.value.enabled,"onUpdate:modelValue":o[17]||(o[17]=u=>a.value.enabled=u)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(r,{span:12},{default:l(()=>[e(d,{prop:"recommendable",rules:{required:!0,message:()=>t.$t("v.required")}},{label:l(()=>[e(_e,{message:"block.recommendable"})]),default:l(()=>[e(f,{modelValue:a.value.recommendable,"onUpdate:modelValue":o[18]||(o[18]=u=>a.value.recommendable=u)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:2},1024)]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","focus","initValues","toValues","values","model-value"])}}})),Be={class:"mb-3"},De={class:"app-block mt-3"},Se={key:1},Me={key:1},Ce={name:"BlockList"},Oe=Q(W(C({},Ce),{setup(b){const{t:m}=ae(),a=q({}),t=q(),o=q(),h=q([]),d=q([]),r=q(!1),D=q(!1),M=q(),f=te(()=>h.value.map(i=>i.id)),_=q(!1),I=async()=>{r.value=!0;try{h.value=await ke(W(C({},ne(a.value)),{Q_OrderBy:t.value})),_.value=Object.values(a.value).filter(i=>i!==void 0&&i!=="").length>0||t.value!==void 0}finally{r.value=!1}};oe(I);const V=({column:i,prop:p,order:w})=>{var R;p?t.value=((R=i.sortBy)!=null?R:p)+(w==="descending"?"_desc":""):t.value=void 0,I()},u=()=>I(),S=()=>{o.value.clearSort(),me(a.value),t.value=void 0,I()},U=()=>{M.value=void 0,D.value=!0},F=i=>{M.value=i,D.value=!0},E=async i=>{await j(i),I(),de.success(m("success"))},G=async(i,p)=>{const w=pe(i,h.value,p);await Ve(w.map(R=>R.id))};return(i,p)=>{const w=$("el-button"),R=$("el-popconfirm"),c=$("el-table-column"),B=$("el-tag"),J=$("el-table"),K=ue("loading");return g(),z("div",null,[A("div",Be,[e(n(ce),{params:a.value,onSearch:u,onReset:S},{default:l(()=>[e(n(ye),{label:i.$t("block.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),A("div",null,[e(w,{type:"primary",disabled:n(H)("block:create"),icon:n(se),onClick:p[0]||(p[0]=s=>U())},{default:l(()=>[k(v(i.$t("add")),1)]),_:1},8,["disabled","icon"]),e(R,{title:i.$t("confirmDelete"),onConfirm:p[1]||(p[1]=s=>E(d.value.map(N=>N.id)))},{reference:l(()=>[e(w,{disabled:d.value.length<=0||n(H)("block:delete"),icon:n(re)},{default:l(()=>[k(v(i.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(we,{disabled:d.value.length<=0||_.value||n(H)("org:update"),onMove:p[2]||(p[2]=s=>G(d.value,s)),class:"ml-2"},null,8,["disabled"]),e(n(qe),{name:"block",class:"ml-2"})]),A("div",De,[ie((g(),y(J,{ref_key:"table",ref:o,data:h.value,onSelectionChange:p[3]||(p[3]=s=>d.value=s),onRowDblclick:p[4]||(p[4]=s=>F(s.id)),onSortChange:V},{default:l(()=>[e(n(Ie),{name:"block"},{default:l(()=>[e(c,{type:"selection",width:"45"}),e(c,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(c,{property:"name",label:i.$t("block.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(c,{property:"alias",label:i.$t("block.alias"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(c,{property:"scope",label:i.$t("block.scope"),sortable:"custom",formatter:s=>i.$t(`block.scope.${s.scope}`)},{default:l(({row:s})=>[s.scope===2?(g(),y(B,{key:0,type:"success",size:"small"},{default:l(()=>[k(v(i.$t(`block.scope.${s.scope}`)),1)]),_:2},1024)):(g(),y(B,{key:1,type:"info",size:"small"},{default:l(()=>[k(v(i.$t(`block.scope.${s.scope}`)),1)]),_:2},1024))]),_:1},8,["label","formatter"]),e(c,{property:"withSubtitle",label:i.$t("block.withSubtitle"),sortable:"custom",display:"none"},{default:l(({row:s})=>[e(B,{type:s.withSubtitle?"success":"info",size:"small"},{default:l(()=>[k(v(i.$t(s.withSubtitle?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(c,{property:"withDescription",label:i.$t("block.withDescription"),sortable:"custom"},{default:l(({row:s})=>[e(B,{type:s.withDescription?"success":"info",size:"small"},{default:l(()=>[k(v(i.$t(s.withDescription?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(c,{property:"withImage",label:i.$t("block.withImage"),sortable:"custom"},{default:l(({row:s})=>[s.withImage?(g(),z("span",Se,v(`${s.imageWidth} * ${s.imageHeight}`),1)):(g(),y(B,{key:0,type:s.withImage?"success":"info",size:"small"},{default:l(()=>[k(v(i.$t(s.withImage?"yes":"no")),1)]),_:2},1032,["type"]))]),_:1},8,["label"]),e(c,{property:"withMobileImage",label:i.$t("block.withMobileImage"),sortable:"custom","min-width":"120",display:"none"},{default:l(({row:s})=>[s.withMobileImage?(g(),z("span",Me,v(`${s.mobileImageWidth} * ${s.mobileImageHeight}`),1)):(g(),y(B,{key:0,type:s.withMobileImage?"success":"info",size:"small"},{default:l(()=>[k(v(i.$t(s.withMobileImage?"yes":"no")),1)]),_:2},1032,["type"]))]),_:1},8,["label"]),e(c,{property:"enabled",label:i.$t("block.enabled"),sortable:"custom"},{default:l(({row:s})=>[e(B,{type:s.enabled?"success":"info",size:"small"},{default:l(()=>[k(v(i.$t(s.enabled?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(c,{label:i.$t("table.action")},{default:l(({row:s})=>[e(w,{type:"primary",disabled:n(H)("block:update"),onClick:N=>F(s.id),size:"small",link:""},{default:l(()=>[k(v(i.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(R,{title:i.$t("confirmDelete"),onConfirm:N=>E([s.id])},{reference:l(()=>[e(w,{type:"primary",disabled:n(H)("block:delete"),size:"small",link:""},{default:l(()=>[k(v(i.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[K,r.value]])]),e(Re,{modelValue:D.value,"onUpdate:modelValue":p[5]||(p[5]=s=>D.value=s),beanId:M.value,beanIds:n(f),onFinished:I},null,8,["modelValue","beanId","beanIds"])])}}}));export{Oe as default};
