System.register(["./index-legacy-CiIiERxr.js","./tree-legacy-Ctw3uqha.js","./content-legacy-CaWWoJUd.js","./system-legacy-XJpditt_.js","./QueryItem.vue_vue_type_script_setup_true_lang-legacy-B_0gkePB.js","./ListMove.vue_vue_type_script_setup_true_lang-legacy-xBzlqoIZ.js","./config-legacy-B0hgRqww.js","./data-legacy-D9lZwenC.js","./FieldItem.vue_vue_type_script_setup_true_lang-legacy-BTlB69cy.js","./DialogForm.vue_vue_type_script_setup_true_lang-legacy-TqTurFLS.js","./Tinymce-legacy-X5tr5Kiq.js","./TuiEditor-legacy-M-25ygIo.js","./FileListUpload.vue_vue_type_style_index_0_scoped_8f839ee5_lang-legacy-pX6CKIrZ.js","./vuedraggable.umd-legacy-BtWPcdPw.js","./BaseUpload.vue_vue_type_style_index_0_scoped_bf818630_lang-legacy-B9GsYx7d.js","./BaseUpload-legacy-DaqKFJ6f.js","./index-legacy-DP77S-U3.js","./sortable.esm-legacy-bb6EEu-C.js"],(function(e,l){"use strict";var a,u,n,t,d,o,r,s,i,m,c,v,p,b,h,y,f,_,g,w,V,k,$,q,C,T,U,I,M,x,K,S,D,j,z,B,E,F,R,L,O,N,P,Q,J,H,A,G,W,Z,X,Y,ee,le,ae,ue,ne,te,de,oe,re,se,ie,me;return{setters:[e=>{a=e.d,u=e.p,n=e.r,t=e.ac,d=e.Z,o=e.v,r=e.b,s=e.e,i=e.f,m=e.w,c=e.i,v=e.j,p=e.aq,b=e.l,h=e.t,y=e.h,f=e.I,_=e.a9,g=e.aa,w=e.k,V=e._,k=e.u,$=e.o,q=e.c,C=e.g,T=e.aE,U=e.E,I=e.aL,M=e.aM,x=e.at,K=e.ak,S=e.ah,D=e.aN,j=e.aD},e=>{z=e.c,B=e.d,E=e.t},e=>{F=e.g,R=e.H,L=e.I,O=e.J,N=e.K,P=e.L,Q=e.M,J=e.h,H=e.N,A=e.O},e=>{G=e.e,W=e.f},e=>{Z=e._,X=e.a,Y=e.b,ee=e.c},e=>{le=e._},e=>{ae=e.b,ue=e.q},e=>{ne=e.a,te=e.m,de=e.g},e=>{oe=e._},e=>{re=e._},e=>{se=e.T},e=>{ie=e.T},e=>{me=e.a},null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".label-top[data-v-e1490852] .el-form-item{margin-bottom:12px}.label-top[data-v-e1490852] .el-form-item__label{margin-bottom:4px;width:100%!important}\n",document.head.appendChild(l);const ce={class:"w-full"},ve=a({name:"ChannelForm",__name:"ChannelForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0},parent:{type:Object,default:null}},emits:{"update:modelValue":null,finished:null},setup(e,{emit:l}){const a=e,V=l,{modelValue:k,parent:$}=u(a),q=n(),C=n({}),T=n([]),U=n([]),I=n([]),M=n([]),x=n([]),K=n([]),S=n([]),D=n([]),j=n(),A=t((()=>M.value.find((e=>e.id===j.value)))),W=t((()=>ne(te(de().channel.mains,A.value?.mains,"channel")))),Z=t((()=>ne(te(de().channel.asides,A.value?.asides,"channel")))),X=t((()=>JSON.parse(A.value?.customs||"[]"))),Y=t((()=>{const e=z(I.value,C.value.id);return d.allChannelPermission?e:B(e,K.value)})),ee=async()=>{I.value=E(await F())},le=async()=>{await ee(),V("finished")};o(k,(()=>{k.value&&(j.value=$.value?.articleModelId??M.value[0]?.id,(async()=>{K.value=await H()})(),(async()=>{M.value=await ue({type:"channel"}),null==j.value&&M.value.length>0&&(j.value=M.value[0].id)})(),(async()=>{x.value=await ue({type:"article"})})(),(async()=>{S.value=await Q()})(),(async()=>{D.value=await J()})(),(async()=>{d.epRank>0&&(T.value=await G({category:"sys_article",deployed:!0}))})(),(async()=>{d.epRank>=3&&(U.value=await ae())})())})),o(X,(()=>{ve(C.value.customs)}));const ve=e=>(X.value.forEach((l=>{null==e[l.code]&&(e[l.code]=l.defaultValue,null!=l.defaultValueKey&&(e[l.code+"Key"]=l.defaultValueKey))})),e);return(l,a)=>{const u=r("el-input"),n=r("el-form-item"),t=r("el-col"),o=r("el-checkbox"),V=r("el-option"),k=r("el-select"),I=r("el-switch"),z=r("el-radio"),B=r("el-radio-group"),E=r("el-row"),F=r("el-tree-select"),Q=r("el-input-number"),J=r("el-tab-pane"),H=r("el-tabs");return s(),i(re,{values:C.value,"onUpdate:values":a[28]||(a[28]=e=>C.value=e),name:l.$t("menu.content.channel"),"query-bean":v(L),"create-bean":v(O),"update-bean":v(N),"delete-bean":v(P),"bean-id":e.beanId,"bean-ids":e.beanIds,focus:q.value,"init-values":e=>({parentId:e?.parentId??v($)?.id,type:1,channelModelId:e?.channelModelId??v($)?.channelModelId??M.value[0]?.id,articleModelId:e?.articleModelId??v($)?.articleModelId??x.value[0]?.id,nav:e?.nav??v($)?.nav??!0,channelTemplate:e?.channelTemplate??v($)?.channelTemplate??S.value[0],articleTemplate:e?.articleTemplate??v($)?.articleTemplate??D.value[0],pageSize:20,allowComment:e?.allowComment??v($)?.allowComment??!0,allowContribute:e?.allowContribute??v($)?.allowContribute??!0,allowSearch:e?.allowSearch??v($)?.allowSearch??!0,orderDesc:e?.orderDesc??v($)?.orderDesc??!0,customs:{}}),"to-values":e=>({...e}),perms:"channel","model-value":e.modelValue,"disable-edit":e=>!v(d).allChannelPermission&&null!=e.id&&!K.value.includes(e.id),"label-width":"120px",large:"","onUpdate:modelValue":a[29]||(a[29]=e=>l.$emit("update:modelValue",e)),onFinished:le,onBeanChange:a[30]||(a[30]=async e=>{j.value=e?.channelModelId??v($)?.channelModelId??x.value[0]?.id,await ee()})},{default:m((({bean:e})=>[c(E,null,{default:m((()=>[c(t,{span:18},{default:m((()=>[c(E,null,{default:m((()=>[c(t,{span:W.value.name.double?12:24},{default:m((()=>[c(n,{prop:"name",label:W.value.name.name??l.$t("channel.name"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:m((()=>[c(u,{ref_key:"focus",ref:q,modelValue:C.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value.name=e),maxlength:"50"},null,8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"]),c(t,{span:W.value.alias.double?12:24},{default:m((()=>[c(n,{prop:"alias",rules:[{required:!0,message:()=>l.$t("v.required")},{pattern:/^[\w-]*$/,message:()=>l.$t("channel.error.aliasPattern")},{asyncValidator:async(a,u,n)=>{u!==e.alias&&await v(R)(u)?n(l.$t("channel.error.aliasExist")):n()}}]},{label:m((()=>[c(p,{label:W.value.alias.name??l.$t("channel.alias"),message:"channel.alias",help:""},null,8,["label"])])),default:m((()=>[c(u,{modelValue:C.value.alias,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value.alias=e),maxlength:"50"},null,8,["modelValue"])])),_:2},1032,["rules"])])),_:2},1032,["span"]),3===C.value.type?(s(),i(t,{key:0,span:W.value.linkUrl.double?12:24},{default:m((()=>[c(n,{prop:"linkUrl",rules:[{required:!0,message:()=>l.$t("v.required")},{pattern:/^(http|\/).*$/,message:()=>l.$t("channel.error.linkUrl")}]},{label:m((()=>[c(p,{label:W.value.linkUrl.name??l.$t("channel.linkUrl"),message:"channel.linkUrl",help:""},null,8,["label"])])),default:m((()=>[c(u,{modelValue:C.value.linkUrl,"onUpdate:modelValue":a[3]||(a[3]=e=>C.value.linkUrl=e),maxlength:"255"},{append:m((()=>[c(o,{modelValue:C.value.targetBlank,"onUpdate:modelValue":a[2]||(a[2]=e=>C.value.targetBlank=e)},{default:m((()=>[b(h(l.$t("channel.targetBlank")),1)])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0),C.value.type<3?(s(),f(_,{key:1},[W.value.seoTitle.show?(s(),i(t,{key:0,span:W.value.seoTitle.double?12:24},{default:m((()=>[c(n,{prop:"seoTitle",rules:W.value.seoTitle.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:W.value.seoTitle.name??l.$t("channel.seoTitle"),message:"channel.seoTitle",help:""},null,8,["label"])])),default:m((()=>[c(u,{modelValue:C.value.seoTitle,"onUpdate:modelValue":a[4]||(a[4]=e=>C.value.seoTitle=e),maxlength:"150"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0),W.value.seoKeywords.show?(s(),i(t,{key:1,span:W.value.seoKeywords.double?12:24},{default:m((()=>[c(n,{prop:"seoKeywords",rules:W.value.seoKeywords.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:W.value.seoKeywords.name??l.$t("channel.seoKeywords"),message:"channel.seoKeywords",help:""},null,8,["label"])])),default:m((()=>[c(u,{modelValue:C.value.seoKeywords,"onUpdate:modelValue":a[5]||(a[5]=e=>C.value.seoKeywords=e),maxlength:"150"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0),W.value.seoDescription.show?(s(),i(t,{key:2,span:W.value.seoDescription.double?12:24},{default:m((()=>[c(n,{prop:"seoDescription",rules:W.value.seoDescription.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:W.value.seoDescription.name??l.$t("channel.seoDescription"),message:"channel.seoDescription",help:""},null,8,["label"])])),default:m((()=>[c(u,{modelValue:C.value.seoDescription,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value.seoDescription=e),maxlength:"1000"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0)],64)):y("",!0),W.value.image.show?(s(),i(t,{key:2,span:W.value.image.double?12:24},{default:m((()=>[c(n,{prop:"image",label:W.value.image.name??l.$t("channel.image"),rules:W.value.image.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(v(me),{modelValue:C.value.image,"onUpdate:modelValue":a[7]||(a[7]=e=>C.value.image=e),height:W.value.image.imageHeight,width:W.value.image.imageWidth,mode:W.value.image.imageMode},null,8,["modelValue","height","width","mode"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),W.value.channelModel.show?(s(),i(t,{key:3,span:W.value.channelModel.double?12:24},{default:m((()=>[c(n,{prop:"channelModelId",label:W.value.channelModel.name??l.$t("channel.channelModel"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:m((()=>[c(k,{modelValue:C.value.channelModelId,"onUpdate:modelValue":a[8]||(a[8]=e=>C.value.channelModelId=e),class:"w-full",onChange:a[9]||(a[9]=e=>{j.value=e})},{default:m((()=>[(s(!0),f(_,null,g(M.value,(e=>(s(),i(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),W.value.articleModel.show?(s(),i(t,{key:4,span:W.value.articleModel.double?12:24},{default:m((()=>[c(n,{prop:"articleModelId",label:W.value.articleModel.name??l.$t("channel.articleModel"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:m((()=>[c(k,{modelValue:C.value.articleModelId,"onUpdate:modelValue":a[10]||(a[10]=e=>C.value.articleModelId=e),class:"w-full"},{default:m((()=>[(s(!0),f(_,null,g(x.value,(e=>(s(),i(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),[3,4,5].includes(C.value.type)?y("",!0):(s(),f(_,{key:5},[W.value.channelTemplate.show?(s(),i(t,{key:0,span:W.value.channelTemplate.double?12:24},{default:m((()=>[c(n,{prop:"channelTemplate",label:W.value.channelTemplate.name??l.$t("channel.channelTemplate"),rules:W.value.channelTemplate.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(k,{modelValue:C.value.channelTemplate,"onUpdate:modelValue":a[11]||(a[11]=e=>C.value.channelTemplate=e),class:"w-full"},{default:m((()=>[(s(!0),f(_,null,g(S.value,(e=>(s(),i(V,{key:e,label:e+".html",value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),W.value.articleTemplate.show?(s(),i(t,{key:1,span:W.value.articleTemplate.double?12:24},{default:m((()=>[c(n,{prop:"articleTemplate",label:W.value.articleTemplate.name??l.$t("channel.articleTemplate"),rules:W.value.articleTemplate.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(k,{modelValue:C.value.articleTemplate,"onUpdate:modelValue":a[12]||(a[12]=e=>C.value.articleTemplate=e),class:"w-full"},{default:m((()=>[(s(!0),f(_,null,g(D.value,(e=>(s(),i(V,{key:e,label:e+".html",value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0)],64)),W.value.allowComment.show?(s(),i(t,{key:6,span:W.value.allowComment.double?12:24},{default:m((()=>[c(n,{prop:"allowComment",label:W.value.allowComment.name??l.$t("channel.allowComment"),rules:W.value.allowComment.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(I,{modelValue:C.value.allowComment,"onUpdate:modelValue":a[13]||(a[13]=e=>C.value.allowComment=e)},null,8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),W.value.allowContribute.show?(s(),i(t,{key:7,span:W.value.allowContribute.double?12:24},{default:m((()=>[c(n,{prop:"allowContribute",label:W.value.allowContribute.name??l.$t("channel.allowContribute"),rules:W.value.allowContribute.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(I,{modelValue:C.value.allowContribute,"onUpdate:modelValue":a[14]||(a[14]=e=>C.value.allowContribute=e)},null,8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0),W.value.nav.show?(s(),i(t,{key:8,span:W.value.nav.double?12:24},{default:m((()=>[c(n,{prop:"nav",rules:W.value.nav.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:W.value.nav.name??l.$t("channel.nav"),message:"channel.nav",help:""},null,8,["label"])])),default:m((()=>[c(I,{modelValue:C.value.nav,"onUpdate:modelValue":a[15]||(a[15]=e=>C.value.nav=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0),W.value.allowSearch.show?(s(),i(t,{key:9,span:W.value.allowSearch.double?12:24},{default:m((()=>[c(n,{prop:"allowSearch",rules:W.value.allowSearch.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:W.value.allowSearch.name??l.$t("channel.allowSearch"),message:"channel.allowSearch",help:""},null,8,["label"])])),default:m((()=>[c(I,{modelValue:C.value.allowSearch,"onUpdate:modelValue":a[16]||(a[16]=e=>C.value.allowSearch=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):y("",!0),(s(!0),f(_,null,g(X.value,(e=>(s(),i(t,{key:e.code,span:e.double?12:24},{default:m((()=>[c(n,{prop:`customs.${e.code}`,rules:e.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:m((()=>[c(p,{label:e.name},null,8,["label"])])),default:m((()=>[c(oe,{modelValue:C.value.customs[e.code],"onUpdate:modelValue":l=>C.value.customs[e.code]=l,"model-key":C.value.customs[e.code+"Key"],"onUpdate:modelKey":l=>C.value.customs[e.code+"Key"]=l,field:e},null,8,["modelValue","onUpdate:modelValue","model-key","onUpdate:modelKey","field"])])),_:2},1032,["prop","rules"])])),_:2},1032,["span"])))),128)),2===C.value.type?(s(),i(t,{key:10,span:W.value.text.double?12:24},{default:m((()=>[c(n,{prop:"text",label:W.value.text.name??l.$t("channel.text"),rules:W.value.text.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[w("div",ce,[W.value.text.editorSwitch?(s(),i(B,{key:0,modelValue:C.value.editorType,"onUpdate:modelValue":a[17]||(a[17]=e=>C.value.editorType=e),class:"mr-6",onChange:a[18]||(a[18]=()=>C.value.markdown="")},{default:m((()=>[(s(),f(_,null,g([1,2],(e=>c(z,{key:e,value:e},{default:m((()=>[b(h(l.$t(`model.field.editorType.${e}`)),1)])),_:2},1032,["value"]))),64))])),_:1},8,["modelValue"])):y("",!0),2===C.value.editorType?(s(),i(v(ie),{key:1,modelValue:C.value.markdown,"onUpdate:modelValue":a[19]||(a[19]=e=>C.value.markdown=e),html:C.value.text,"onUpdate:html":a[20]||(a[20]=e=>C.value.text=e),class:"leading-6"},null,8,["modelValue","html"])):(s(),i(v(se),{key:2,ref:"tinyText",modelValue:C.value.text,"onUpdate:modelValue":a[21]||(a[21]=e=>C.value.text=e)},null,8,["modelValue"]))])])),_:1},8,["label","rules"])])),_:1},8,["span"])):y("",!0)])),_:2},1024)])),_:2},1024),c(t,{span:6,class:"el-form--label-top label-top"},{default:m((()=>[c(H,{type:"border-card",class:"ml-5"},{default:m((()=>[c(J,{label:l.$t("channel.tabs.setting")},{default:m((()=>[c(n,{prop:"parentId",label:Z.value.parent.name??l.$t("channel.parent")},{default:m((()=>[c(F,{modelValue:C.value.parentId,"onUpdate:modelValue":a[22]||(a[22]=e=>C.value.parentId=e),data:Y.value,"node-key":"id",props:{label:"name",disabled:"disabled"},"render-after-expand":!1,"check-strictly":"",clearable:"",class:"w-full"},null,8,["modelValue","data"])])),_:1},8,["label"]),c(n,{prop:"type",label:Z.value.type.name??l.$t("channel.type"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:m((()=>[c(k,{modelValue:C.value.type,"onUpdate:modelValue":a[23]||(a[23]=e=>C.value.type=e),class:"w-full"},{default:m((()=>[(s(),f(_,null,g([1,2,3,4],(e=>c(V,{key:e,label:l.$t(`channel.type.${e}`),value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"]),c(n,{prop:"processKey",label:Z.value.processKey.name??l.$t("channel.processKey"),rules:Z.value.processKey.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(k,{modelValue:C.value.processKey,"onUpdate:modelValue":a[24]||(a[24]=e=>C.value.processKey=e),clearable:"",class:"w-full"},{default:m((()=>[(s(!0),f(_,null,g(T.value,(e=>(s(),i(V,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"]),v(d).epRank>=3&&Z.value.performanceType.show?(s(),i(n,{key:0,prop:"performanceType",label:Z.value.performanceType.name??l.$t("channel.performanceType"),rules:Z.value.performanceType.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:m((()=>[c(k,{modelValue:C.value.performanceTypeId,"onUpdate:modelValue":a[25]||(a[25]=e=>C.value.performanceTypeId=e),clearable:"",class:"w-full"},{default:m((()=>[(s(!0),f(_,null,g(U.value,(e=>(s(),i(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])):y("",!0),c(n,{prop:"pageSize",label:Z.value.pageSize.name??l.$t("channel.pageSize"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:m((()=>[c(Q,{modelValue:C.value.pageSize,"onUpdate:modelValue":a[26]||(a[26]=e=>C.value.pageSize=e),min:1,max:200},null,8,["modelValue"])])),_:1},8,["label","rules"]),c(n,{prop:"orderDesc",rules:{required:!0,message:()=>l.$t("v.required")}},{label:m((()=>[c(p,{label:Z.value.orderDesc.name??l.$t("channel.orderDesc"),message:"channel.orderDesc",help:""},null,8,["label"])])),default:m((()=>[c(I,{modelValue:C.value.orderDesc,"onUpdate:modelValue":a[27]||(a[27]=e=>C.value.orderDesc=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:2},1024)])),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value","disable-edit"])}}}),pe=V(ve,[["__scopeId","data-v-e1490852"]]),be={class:"my-1 ml-2"},he={class:"mb-3"},ye={class:"mt-3 app-block"};e("default",a({name:"ChannelList",__name:"ChannelList",setup(e){const{t:l}=k(),a=n({}),u=n(),p=n(),y=n([]),f=n([]),_=n(!1),g=n(!1),V=n(),z=n(),B=t((()=>y.value.map((e=>e.id)))),R=n(!1),L=n([]),O=n([]),N=n(),Q=n([]),J=n(!1),G=n(),ae=n(),ue=e=>d.allChannelPermission||L.value.includes(e.id);o(G,(e=>{N.value.filter(e)}));const ne=async()=>{_.value=!0;try{const e=Object.values(a.value).filter((e=>void 0!==e&&""!==e)).length>0;y.value=await F({...j(a.value),parentId:ae.value?.id,isIncludeChildren:e,Q_OrderBy:u.value}),R.value=e||void 0!==u.value}finally{_.value=!1}},te=()=>{(async()=>{J.value=!0;try{Q.value=E(await F({isOnlyParent:!0})),D((()=>{null!=G.value&&N.value.filter(G.value),N.value.setCurrentKey(ae.value?.id)}))}finally{J.value=!1}})(),ne()},de=async()=>{L.value=await H()};$((()=>{te(),(async()=>{d.epRank>0&&(O.value=await W({category:"sys_article",latestVersion:!0}))})(),de()}));const oe=({column:e,prop:l,order:a})=>{u.value=l&&a?(e.sortBy??l)+("descending"===a?"_desc":""):void 0,te()},re=()=>{te(),de()},se=()=>ne(),ie=()=>{p.value.clearSort(),T(a.value),u.value=void 0,ne()},me=e=>{z.value=void 0,V.value=e??ae.value,g.value=!0},ce=e=>{z.value=e,V.value=null,g.value=!0},ve=async e=>{await P(e),te(),U.success(l("success"))};return(e,l)=>{const u=r("el-input"),n=r("el-button"),t=r("el-tree"),d=r("el-scrollbar"),o=r("el-aside"),k=r("el-popconfirm"),$=r("el-table-column"),T=r("el-tag"),U=r("el-table"),D=r("el-main"),j=r("el-container"),E=q("loading");return s(),i(j,null,{default:m((()=>[c(o,{width:"220px",class:"pr-3"},{default:m((()=>[c(d,{class:"p-2 bg-white rounded-sm"},{default:m((()=>[c(u,{modelValue:G.value,"onUpdate:modelValue":l[0]||(l[0]=e=>G.value=e),"suffix-icon":v(M),size:"small"},null,8,["modelValue","suffix-icon"]),w("div",be,[c(n,{type:null==ae.value?"primary":void 0,link:"",onClick:l[1]||(l[1]=()=>{N.value.setCurrentKey(null),ae.value=void 0,se()})},{default:m((()=>[b(h(e.$t("channel.root")),1)])),_:1},8,["type"])]),C(c(t,{ref_key:"channelTree",ref:N,data:Q.value,props:{label:"name"},"expand-on-click-node":!1,"node-key":"id","highlight-current":"","filter-node-method":(e,l)=>!e||l.name.includes(e),onNodeClick:l[2]||(l[2]=e=>{ae.value=e,se()})},null,8,["data","filter-node-method"]),[[E,J.value]])])),_:1})])),_:1}),c(D,{class:"p-0"},{default:m((()=>[w("div",he,[c(v(Z),{params:a.value,onSearch:se,onReset:ie},{default:m((()=>[c(v(X),{label:e.$t("channel.name"),name:"Q_Contains_name"},null,8,["label"]),c(v(X),{label:e.$t("channel.alias"),name:"Q_Contains_alias"},null,8,["label"])])),_:1},8,["params"])]),w("div",null,[c(n,{type:"primary",disabled:v(x)("channel:create"),icon:v(K),onClick:l[3]||(l[3]=()=>me(void 0))},{default:m((()=>[b(h(e.$t("add")),1)])),_:1},8,["disabled","icon"]),c(k,{title:e.$t("confirmDelete"),onConfirm:l[4]||(l[4]=()=>ve(f.value.map((e=>e.id))))},{reference:m((()=>[c(n,{disabled:f.value.length<=0||v(x)("channel:delete"),icon:v(S)},{default:m((()=>[b(h(e.$t("delete")),1)])),_:1},8,["disabled","icon"])])),_:1},8,["title"]),c(le,{disabled:f.value.length<=0||R.value||v(x)("channel:update"),class:"ml-2",onMove:l[5]||(l[5]=e=>(async(e,l)=>{const a=I(e,y.value,l);await A(a),await te(),e.forEach((()=>{p.value.toggleRowSelection(y.value)}))})(f.value,e))},null,8,["disabled"]),c(v(Y),{name:"channel",class:"ml-2"})]),w("div",ye,[C((s(),i(U,{ref_key:"table",ref:p,"row-key":"id",data:y.value,onSelectionChange:l[6]||(l[6]=e=>f.value=e),onRowDblclick:l[7]||(l[7]=e=>ce(e.id)),onSortChange:oe},{default:m((()=>[c(v(ee),{name:"channel"},{default:m((()=>[c($,{type:"selection",selectable:ue,width:"45"}),c($,{property:"name",label:e.$t("channel.name"),"min-width":"120",sortable:"custom"},null,8,["label"]),c($,{property:"alias",label:e.$t("channel.alias"),"min-width":"80",sortable:"custom"},null,8,["label"]),c($,{property:"channelModel.name",label:e.$t("channel.channelModel"),"sort-by":"channelModel@model-name",display:"none",sortable:"custom","min-width":"60"},null,8,["label"]),c($,{property:"articleModel.name",label:e.$t("channel.articleModel"),"sort-by":"articleModel@model-name",sortable:"custom","min-width":"60"},null,8,["label"]),c($,{property:"processKey",label:e.$t("channel.processKey"),"min-width":"60",sortable:"custom","show-overflow-tooltip":""},{default:m((({row:e})=>[b(h(null!=e.processKey?O.value.find((l=>l.key===e.processKey))?.name:void 0),1)])),_:1},8,["label"]),c($,{property:"nav",label:e.$t("channel.nav"),"min-width":"40"},{default:m((({row:l})=>[c(T,{type:l.nav?"success":"info",size:"small"},{default:m((()=>[b(h(e.$t(l.nav?"yes":"no")),1)])),_:2},1032,["type"])])),_:1},8,["label"]),c($,{property:"id",label:"ID",width:"170",sortable:"custom"}),c($,{label:e.$t("table.action")},{default:m((({row:l})=>[c(n,{type:"primary",disabled:v(x)("channel:create")||!ue(l),size:"small",link:"",onClick:()=>me(l)},{default:m((()=>[b(h(e.$t("addChild")),1)])),_:2},1032,["disabled","onClick"]),c(n,{type:"primary",disabled:v(x)("channel:update"),size:"small",link:"",onClick:()=>ce(l.id)},{default:m((()=>[b(h(e.$t("edit")),1)])),_:2},1032,["disabled","onClick"]),c(k,{title:e.$t("confirmDelete"),onConfirm:()=>ve([l.id])},{reference:m((()=>[c(n,{type:"primary",disabled:v(x)("channel:delete")||!ue(l),size:"small",link:""},{default:m((()=>[b(h(e.$t("delete")),1)])),_:2},1032,["disabled"])])),_:2},1032,["title","onConfirm"])])),_:1},8,["label"])])),_:1})])),_:1},8,["data"])),[[E,_.value]])]),c(pe,{modelValue:g.value,"onUpdate:modelValue":l[8]||(l[8]=e=>g.value=e),"bean-id":z.value,"bean-ids":B.value,parent:V.value,onFinished:re},null,8,["modelValue","bean-id","bean-ids","parent"])])),_:1})])),_:1})}}}))}}}));
