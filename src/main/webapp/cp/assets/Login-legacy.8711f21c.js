!function(){var e=document.createElement("style");e.innerHTML="[data-v-04d9c226] .captcha .el-input-group__append{padding:0}\n",document.head.appendChild(e),System.register(["./vendor-legacy.c673f215.js","./index-legacy.ab0556e1.js"],(function(e){"use strict";var a,l,t,u,s,r,o,n,d,i,p,c,m,v,g,h,f,w,y,V,b,x,$,_,k,q,M,C,U,P,S,L,I,A,D,F,T,j,O;return{setters:[function(e){a=e.g,l=e.u,t=e.I,u=e.M,s=e.j,r=e.N,o=e.o,n=e.k,d=e.w,i=e.O,p=e.x,c=e.l,m=e.m,v=e.y,g=e.P,h=e.A,f=e.K,w=e.Q,y=e.af,V=e.D,b=e.p,x=e.J,$=e.q,_=e.X,k=e.ag,q=e.ah,M=e.e},function(e){C=e.q,U=e.s,P=e.p,S=e.a,L=e.c,I=e.t,A=e.b,D=e.d,F=e._,T=e.e,j=e.f,O=e.l}],execute:function(){const R=a({name:"ChangePassword",props:{modelValue:{type:Boolean,required:!0}},emits:{"update:modelValue":null},setup(e,{emit:a}){const{t:y}=l(),V=t({}),b=t(),x=t(),$=t(!1),_=t(!1),k=t(""),q=t();u((async()=>{$.value=!0;try{k.value=await C()}finally{$.value=!1}}));const M=()=>{b.value.validate((async e=>{if(e){_.value=!0;try{const e=S(V.value.password,k.value),l=await L({...V.value,password:e});if(0!==l.status)return void(q.value=l.message);q.value=void 0,b.value.resetFields(),w.success(y("success")),a("update:modelValue",!1)}finally{_.value=!1}}}))};return(a,l)=>{const t=s("el-alert"),u=s("el-input"),w=s("el-form-item"),y=s("el-button"),k=s("el-form"),C=s("el-dialog"),S=r("loading");return o(),n(C,{title:a.$t("changePassword"),"model-value":e.modelValue,"onUpdate:modelValue":l[4]||(l[4]=e=>a.$emit("update:modelValue",e)),onOpened:l[5]||(l[5]=e=>{var a;null===(a=x.value)||void 0===a||a.focus(),b.value.resetFields()})},{default:d((()=>[i((o(),n(k,{ref_key:"form",ref:b,model:V.value,"label-width":"150px","label-position":"right"},{default:d((()=>[q.value?(o(),n(t,{key:0,title:q.value,type:"error",class:"mb-3",closable:!1,"show-icon":""},null,8,["title"])):p("",!0),c(w,{prop:"username",label:a.$t("user.username"),rules:[{required:!0,message:()=>a.$t("v.required")}]},{default:d((()=>[c(u,{modelValue:V.value.username,"onUpdate:modelValue":l[0]||(l[0]=e=>V.value.username=e),ref_key:"focus",ref:x,maxlength:"30"},null,8,["modelValue"])])),_:1},8,["label","rules"]),c(w,{prop:"password",label:a.$t("user.origPassword"),rules:[{required:!0,message:()=>a.$t("v.required")}]},{default:d((()=>[c(u,{modelValue:V.value.password,"onUpdate:modelValue":l[1]||(l[1]=e=>V.value.password=e),maxlength:"50","show-password":""},null,8,["modelValue"])])),_:1},8,["label","rules"]),c(w,{prop:"plainPassword",label:a.$t("user.newPassword"),rules:[{required:!0,message:()=>a.$t("v.required")},{min:m(U).passwordMinLength,max:m(U).passwordMaxLength,message:()=>a.$t("user.error.passwordLength",{min:m(U).passwordMinLength,max:m(U).passwordMaxLength})},{pattern:m(P)(m(U).passwordStrength),message:()=>a.$t(`user.error.passwordPattern.${m(U).passwordStrength}`)}]},{default:d((()=>[c(u,{modelValue:V.value.plainPassword,"onUpdate:modelValue":l[2]||(l[2]=e=>V.value.plainPassword=e),maxlength:m(U).passwordMaxLength,"show-password":""},null,8,["modelValue","maxlength"])])),_:1},8,["label","rules"]),c(w,{prop:"passwordAgain",label:a.$t("user.passwordAgain"),rules:[{required:!0,message:()=>a.$t("v.required")},{validator:(e,l,t)=>{l!==V.value.plainPassword&&t(a.$t("user.error.passwordNotMatch")),t()}}]},{default:d((()=>[c(u,{modelValue:V.value.passwordAgain,"onUpdate:modelValue":l[3]||(l[3]=e=>V.value.passwordAgain=e),maxlength:"50","show-password":""},null,8,["modelValue"])])),_:1},8,["label","rules"]),v("div",null,[c(y,{loading:_.value,onClick:f(M,["prevent"]),type:"primary","native-type":"submit"},{default:d((()=>[g(h(a.$t("submit")),1)])),_:1},8,["loading","onClick"])])])),_:1},8,["model"])),[[S,$.value]])])),_:1},8,["title","model-value"])}}}),B=a({name:"GetShortMessage",props:{modelValue:{type:Boolean,required:!0}},emits:{"update:modelValue":null,finish:null},setup(e,{emit:a}){const{t:r}=l(),i=t(),V=t(),b=t({}),x=t(!1),$=t(),_=t(),k=t(),q=async()=>{const{token:e,image:a}=await A();_.value="data:image/png;base64,"+a,k.value=e};u((async()=>{q()}));const M=()=>{i.value.validate((async e=>{if(e){x.value=!0;try{var l;const e=await D(null!==(l=k.value)&&void 0!==l?l:"",b.value.captcha,b.value.mobile);if(0!==e.status)return void($.value=e.message);$.value=void 0,i.value.resetFields(),w.success(r("success")),a("finish",e.result.token),a("update:modelValue",!1)}finally{x.value=!1}}}))};return(a,l)=>{const t=s("el-alert"),u=s("el-input"),r=s("el-form-item"),w=s("el-image"),C=s("el-button"),U=s("el-form"),P=s("el-dialog");return o(),n(P,{title:a.$t("getShortMessage"),"model-value":e.modelValue,"onUpdate:modelValue":l[3]||(l[3]=e=>a.$emit("update:modelValue",e)),onOpened:l[4]||(l[4]=e=>{var a;null===(a=V.value)||void 0===a||a.focus(),i.value.resetFields()}),width:"576px"},{default:d((()=>[c(U,{ref_key:"form",ref:i,model:b.value,"label-width":"150px","label-position":"right"},{default:d((()=>[$.value?(o(),n(t,{key:0,title:$.value,type:"error",class:"mb-3",closable:!1,"show-icon":""},null,8,["title"])):p("",!0),c(r,{prop:"mobile",label:a.$t("mobile"),rules:[{required:!0,message:()=>a.$t("v.required")}]},{default:d((()=>[c(u,{modelValue:b.value.mobile,"onUpdate:modelValue":l[0]||(l[0]=e=>b.value.mobile=e),ref_key:"focus",ref:V,maxlength:"30"},null,8,["modelValue"])])),_:1},8,["label","rules"]),c(r,{prop:"captcha",label:a.$t("captcha"),rules:[{required:!0,message:()=>a.$t("v.required")},{asyncValidator:async(e,l,t)=>{null!=k.value&&await m(I)(k.value,l)||t(a.$t("captchaIncorrect")),t()},trigger:"blur"}],class:"captcha"},{default:d((()=>[c(u,{modelValue:b.value.captcha,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value.captcha=e),name:"captcha",placeholder:a.$t("captcha"),"prefix-icon":m(y)},{append:d((()=>[c(w,{src:_.value,style:{height:"30px","margin-right":"1px"},class:"rounded-r cursor-pointer",onClick:l[1]||(l[1]=e=>q()),title:a.$t("clickToRetrieveCaptcha")},null,8,["src","title"])])),_:1},8,["modelValue","placeholder","prefix-icon"])])),_:1},8,["label","rules"]),v("div",null,[c(C,{loading:x.value,onClick:f(M,["prevent"]),type:"primary","native-type":"submit"},{default:d((()=>[g(h(a.$t("submit")),1)])),_:1},8,["loading","onClick"])])])),_:1},8,["model"])])),_:1},8,["title","model-value"])}}});const J={class:"h-full p-3 bg-gray-100"},N={class:"py-5 text-center text-3xl font-bold text-primary"},E={class:"mt-2 text-right"};e("default",F(a({name:"Login",setup(e){const{t:a}=l(),r=t(),i=t({}),w=t(),U=t(!1),P=t(!1),L=t(),D=t(),F=t(),G=t(),H=t(!1),K=t(),Q=V(),X=b(),z=t(!1),W=t(!1),Y=t(60),Z=t(a("getShortMessage")),ee=async()=>{const{token:e,image:a}=await A();L.value="data:image/png;base64,"+a,D.value=e},ae=async()=>{U.value=await T()};u((async()=>{w.value.focus(),w.value.select(),ee(),ae(),(async()=>{P.value=await j()})()})),x((()=>{K.value=Q.query.redirect}));const le=e=>{F.value=e,Y.value-=1,Z.value=String(Y.value);const l=setInterval((()=>{Y.value-=1,Z.value=String(Y.value),Y.value<=0&&(Z.value=a("getShortMessage"),Y.value=60,clearInterval(l))}),1e3)},te=()=>{r.value.validate((async e=>{if(e){H.value=!0;try{const e=await C(),l=S(i.value.password,e),t=await O({...i.value,password:l,captchaToken:D.value,shortMessageToken:F.value});if(0!==t.status)return ae(),void(G.value=t.message);null!=t.result.remainingDays&&M.alert(a("passwordRemaingDays",{remainingDays:t.result.remainingDays}),{type:"warning"}),K.value?X.push(K.value):window.location.reload()}finally{H.value=!1}}}))};return(e,a)=>{const l=s("el-alert"),t=s("el-input"),u=s("el-form-item"),V=s("el-button"),b=s("el-image"),x=s("el-form");return o(),$("div",J,[c(x,{ref_key:"form",ref:r,model:i.value,class:"mx-auto md:max-w-xs"},{default:d((()=>[v("h3",N,h(m("UJCMS")),1),G.value?(o(),n(l,{key:0,title:G.value,type:"error",class:"mb-3",closable:!1,"show-icon":""},null,8,["title"])):p("",!0),c(u,{prop:"username",rules:[{required:!0,message:()=>e.$t("v.required")}]},{default:d((()=>[c(t,{ref_key:"focus",ref:w,modelValue:i.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value.username=e),name:"username",placeholder:e.$t("username"),"prefix-icon":m(_),autocomplete:"on"},null,8,["modelValue","placeholder","prefix-icon"])])),_:1},8,["rules"]),c(u,{prop:"password",rules:[{required:!0,message:()=>e.$t("v.required")}]},{default:d((()=>[c(t,{ref:"password",modelValue:i.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value.password=e),type:"password",name:"password",placeholder:e.$t("password"),"prefix-icon":m(k),"show-password":""},null,8,["modelValue","placeholder","prefix-icon"])])),_:1},8,["rules"]),P.value?(o(),n(u,{key:1,prop:"shortMessageValue",rules:[{required:!0,message:()=>e.$t("v.required")}]},{default:d((()=>[c(t,{modelValue:i.value.shortMessageValue,"onUpdate:modelValue":a[3]||(a[3]=e=>i.value.shortMessageValue=e),name:"shortMessageValue",placeholder:e.$t("shortMessage"),"prefix-icon":m(q)},{append:d((()=>[c(V,{disabled:Y.value<60,onClick:a[2]||(a[2]=e=>W.value=!0)},{default:d((()=>[g(h(Z.value),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue","placeholder","prefix-icon"])])),_:1},8,["rules"])):p("",!0),U.value?(o(),n(u,{key:2,prop:"captchaValue",rules:[{required:!0,message:()=>e.$t("v.required")},{asyncValidator:async(a,l,t)=>{null!=D.value&&await m(I)(D.value,l)||t(e.$t("captchaIncorrect")),t()},trigger:"blur"}],class:"captcha"},{default:d((()=>[c(t,{modelValue:i.value.captchaValue,"onUpdate:modelValue":a[5]||(a[5]=e=>i.value.captchaValue=e),name:"captchaValue",placeholder:e.$t("captcha"),"prefix-icon":m(y)},{append:d((()=>[c(b,{src:L.value,style:{height:"30px","margin-right":"1px"},class:"rounded-r cursor-pointer",onClick:a[4]||(a[4]=e=>ee()),title:e.$t("clickToRetrieveCaptcha")},null,8,["src","title"])])),_:1},8,["modelValue","placeholder","prefix-icon"])])),_:1},8,["rules"])):p("",!0),c(V,{type:"primary","native-type":"submit",class:"w-full",loading:H.value,onClick:f(te,["prevent"])},{default:d((()=>[g(h(e.$t("login")),1)])),_:1},8,["loading","onClick"]),v("div",E,[c(V,{type:"primary",onClick:a[6]||(a[6]=e=>z.value=!0),link:""},{default:d((()=>[g(h(e.$t("changePassword")),1)])),_:1})])])),_:1},8,["model"]),c(R,{modelValue:z.value,"onUpdate:modelValue":a[7]||(a[7]=e=>z.value=e)},null,8,["modelValue"]),c(B,{modelValue:W.value,"onUpdate:modelValue":a[8]||(a[8]=e=>W.value=e),onFinish:le},null,8,["modelValue"])])}}}),[["__scopeId","data-v-04d9c226"]]))}}}))}();
