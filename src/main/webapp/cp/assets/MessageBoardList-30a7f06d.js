import{d as H,r as _,o as Q,a as i,c as f,e as V,w as a,i as m,I as M,k as g,t as c,g as E,ac as A,h as e,ao as p,ad as O,u as se,a1 as te,b as oe,j as N,f as de,av as ne,aB as ue,E as R,ah as C,aa as re,aL as me,a7 as ie,U as pe,az as fe,aA as ge}from"./index-0b297134.js";import{q as ve,c as be,u as _e,d as G,a as ce,b as ye}from"./interaction-21cdda20.js";import{a as Be,_ as Ve,b as $e,c as ke}from"./QueryItem.vue_vue_type_script_setup_true_lang-a71c7d8e.js";import{f as we}from"./content-36f9a437.js";import{T as ze}from"./Tinymce-0c80a6ea.js";import{_ as Ue}from"./DialogForm.vue_vue_type_script_setup_true_lang-99772bc8.js";import"./config-a46f2ebe.js";const Ce={key:0},Se={name:"MessageBoardForm"},De=H({...Se,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(T){const S=_(),l=_({}),k=_([]),D=async()=>{k.value=await we("sys_message_board_type")};return Q(async()=>{D()}),(y,o)=>{const U=i("el-tag"),q=i("el-option"),w=i("el-select"),r=i("el-form-item"),u=i("el-col"),v=i("el-input"),I=i("el-switch"),B=i("el-date-picker"),P=i("el-row");return f(),V(Ue,{values:l.value,"onUpdate:values":o[11]||(o[11]=b=>l.value=b),name:y.$t("menu.interaction.messageBoard"),"query-bean":m(ve),"create-bean":m(be),"update-bean":m(_e),"delete-bean":m(G),"bean-id":T.beanId,"bean-ids":T.beanIds,focus:S.value,"init-values":()=>{var b;return{typeId:(b=k.value[0])==null?void 0:b.id,userType:1,open:!0,status:0}},"to-values":b=>({...b}),perms:"messageBoard","model-value":T.modelValue,large:"","onUpdate:modelValue":o[12]||(o[12]=b=>y.$emit("update:modelValue",b)),onFinished:o[13]||(o[13]=()=>y.$emit("finished"))},{"header-status":a(({isEdit:b})=>[b?(f(),M(A,{key:0},[l.value.status!=null?(f(),M("span",Ce,[l.value.status===0?(f(),V(U,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[g(c(y.$t(`messageBoard.status.${l.value.status}`)),1)]),_:1})):l.value.status===1?(f(),V(U,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[g(c(y.$t(`messageBoard.status.${l.value.status}`)),1)]),_:1})):l.value.status===2?(f(),V(U,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[g(c(y.$t(`messageBoard.status.${l.value.status}`)),1)]),_:1})):(f(),V(U,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>[g("unknown")]),_:1}))])):E("",!0)],64)):E("",!0)]),default:a(({isEdit:b})=>[e(P,null,{default:a(()=>[e(u,{span:24},{default:a(()=>[e(r,{prop:"typeId",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(p,{message:"messageBoard.type"})]),default:a(()=>[e(w,{modelValue:l.value.typeId,"onUpdate:modelValue":o[0]||(o[0]=s=>l.value.typeId=s),class:"w-full"},{default:a(()=>[(f(!0),M(A,null,O(k.value,s=>(f(),V(q,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{prop:"title",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(p,{message:"messageBoard.title"})]),default:a(()=>[e(v,{ref_key:"focus",ref:S,modelValue:l.value.title,"onUpdate:modelValue":o[1]||(o[1]=s=>l.value.title=s),maxlength:"150"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{prop:"text",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(p,{message:"messageBoard.text"})]),default:a(()=>[e(v,{modelValue:l.value.text,"onUpdate:modelValue":o[2]||(o[2]=s=>l.value.text=s),type:"textarea",rows:"8",maxlength:"65535"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),b?(f(),V(u,{key:0,span:24},{default:a(()=>[e(r,{prop:"replyText"},{label:a(()=>[e(p,{message:"messageBoard.replyText"})]),default:a(()=>[e(m(ze),{modelValue:l.value.replyText,"onUpdate:modelValue":o[3]||(o[3]=s=>l.value.replyText=s),class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1})):E("",!0),e(u,{span:12},{default:a(()=>[e(r,{prop:"contact"},{label:a(()=>[e(p,{message:"messageBoard.contact"})]),default:a(()=>[e(v,{modelValue:l.value.contact,"onUpdate:modelValue":o[4]||(o[4]=s=>l.value.contact=s),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"nickname"},{label:a(()=>[e(p,{message:"messageBoard.nickname"})]),default:a(()=>[e(v,{modelValue:l.value.nickname,"onUpdate:modelValue":o[5]||(o[5]=s=>l.value.nickname=s),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"phone"},{label:a(()=>[e(p,{message:"messageBoard.phone"})]),default:a(()=>[e(v,{modelValue:l.value.phone,"onUpdate:modelValue":o[6]||(o[6]=s=>l.value.phone=s),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"email"},{label:a(()=>[e(p,{message:"messageBoard.email"})]),default:a(()=>[e(v,{modelValue:l.value.email,"onUpdate:modelValue":o[7]||(o[7]=s=>l.value.email=s),maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(r,{prop:"address"},{label:a(()=>[e(p,{message:"messageBoard.address"})]),default:a(()=>[e(v,{modelValue:l.value.address,"onUpdate:modelValue":o[8]||(o[8]=s=>l.value.address=s),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"open"},{label:a(()=>[e(p,{message:"messageBoard.open"})]),default:a(()=>[e(I,{modelValue:l.value.open,"onUpdate:modelValue":o[9]||(o[9]=s=>l.value.open=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"recommended"},{label:a(()=>[e(p,{message:"messageBoard.recommended"})]),default:a(()=>[e(I,{modelValue:l.value.recommended,"onUpdate:modelValue":o[10]||(o[10]=s=>l.value.recommended=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"replied"},{label:a(()=>[e(p,{message:"messageBoard.replied"})]),default:a(()=>[e(I,{"model-value":l.value.replied,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"ip"},{label:a(()=>[e(p,{message:"messageBoard.ip"})]),default:a(()=>[e(v,{"model-value":l.value.ip,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"user"},{label:a(()=>[e(p,{message:"messageBoard.user"})]),default:a(()=>{var s;return[e(v,{"model-value":(s=l.value.user)==null?void 0:s.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"created"},{label:a(()=>[e(p,{message:"messageBoard.created"})]),default:a(()=>[e(B,{"model-value":l.value.created,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"replyUser"},{label:a(()=>[e(p,{message:"messageBoard.replyUser"})]),default:a(()=>{var s;return[e(v,{"model-value":(s=l.value.replyUser)==null?void 0:s.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(r,{prop:"replyDate"},{label:a(()=>[e(p,{message:"messageBoard.replyDate"})]),default:a(()=>[e(B,{"model-value":l.value.replyDate,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value"])}}}),qe={class:"mb-3"},Ie={class:"space-x-2"},he={class:"app-block mt-3"},Me={name:"MessageBoardList"},Ye=H({...Me,setup(T){const{t:S}=se(),l=_({}),k=_(),D=_(1),y=_(10),o=_(0),U=_(),q=_([]),w=_([]),r=_(!1),u=_(!1),v=_(),I=te(()=>q.value.map(t=>t.id)),B=async()=>{r.value=!0;try{const{content:t,totalElements:n}=await ce({...ne(l.value),Q_OrderBy:k.value,page:D.value,pageSize:y.value});q.value=t,o.value=n}finally{r.value=!1}};Q(B);const P=({column:t,prop:n,order:z})=>{var L;n&&z?k.value=((L=t.sortBy)!=null?L:n)+(z==="descending"?"_desc":""):k.value=void 0,B()},b=()=>B(),s=()=>{U.value.clearSort(),ue(l.value),k.value=void 0,B()},J=()=>{v.value=void 0,u.value=!0},F=t=>{v.value=t,u.value=!0},Y=async t=>{await G(t),B(),R.success(S("success"))},K=async(t,n)=>{await ye(t,n),B(),R.success(S("success"))};return(t,n)=>{const z=i("el-button"),L=i("el-icon"),W=i("el-dropdown-item"),X=i("el-dropdown-menu"),Z=i("el-dropdown"),j=i("el-popconfirm"),$=i("el-table-column"),h=i("el-tag"),x=i("el-table"),ee=i("el-pagination"),ae=oe("loading");return f(),M("div",null,[N("div",qe,[e(m(Ve),{params:l.value,onSearch:b,onReset:s},{default:a(()=>[e(m(Be),{label:t.$t("messageBoard.title"),name:"Q_Contains_title"},null,8,["label"])]),_:1},8,["params"])]),N("div",Ie,[e(z,{type:"primary",disabled:m(C)("messageBoard:create"),icon:m(re),onClick:n[0]||(n[0]=()=>J())},{default:a(()=>[g(c(t.$t("add")),1)]),_:1},8,["disabled","icon"]),e(Z,{disabled:w.value.length<=0||m(C)("messageBoard:updateStatus")},{dropdown:a(()=>[e(X,null,{default:a(()=>[(f(),M(A,null,O([0,1,2],d=>e(W,{key:d,onClick:()=>K(w.value.map(le=>le.id),d)},{default:a(()=>[g(c(t.$t(`messageBoard.status.${d}`)),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:a(()=>[e(z,{disabled:w.value.length<=0||m(C)("messageBoard:updateStatus")},{default:a(()=>[g(c(t.$t("messageBoard.op.status")),1),e(L,{class:"el-icon--right"},{default:a(()=>[e(m(me))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["disabled"]),e(j,{title:t.$t("confirmDelete"),onConfirm:n[1]||(n[1]=()=>Y(w.value.map(d=>d.id)))},{reference:a(()=>[e(z,{disabled:w.value.length<=0||m(C)("messageBoard:delete"),icon:m(ie)},{default:a(()=>[g(c(t.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(m($e),{name:"messageBoard"})]),N("div",he,[de((f(),V(x,{ref_key:"table",ref:U,data:q.value,onSelectionChange:n[2]||(n[2]=d=>w.value=d),onRowDblclick:n[3]||(n[3]=d=>F(d.id)),onSortChange:P},{default:a(()=>[e(m(ke),{name:"messageBoard"},{default:a(()=>[e($,{type:"selection",width:"45"}),e($,{property:"id",label:"ID",width:"64",sortable:"custom"}),e($,{property:"title",label:t.$t("messageBoard.title"),"min-width":"260",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e($,{property:"type.name",label:t.$t("messageBoard.type"),"min-width":"80","sort-by":"type@dict-name",sortable:"custom"},null,8,["label"]),e($,{property:"user.username",label:t.$t("messageBoard.user"),"min-width":"80","sort-by":"user-username",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e($,{property:"created",label:t.$t("messageBoard.created"),"min-width":"120",sortable:"custom","show-overflow-tooltip":""},{default:a(({row:d})=>[g(c(m(pe)(d.created).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),e($,{property:"replied",label:t.$t("messageBoard.replied"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[e(h,{type:d.replied?"success":"info",size:"small","disable-transitions":""},{default:a(()=>[g(c(t.$t(d.replied?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e($,{property:"status",label:t.$t("messageBoard.status"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[d.status===0?(f(),V(h,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[g(c(t.$t(`messageBoard.status.${d.status}`)),1)]),_:2},1024)):d.status===1?(f(),V(h,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[g(c(t.$t(`messageBoard.status.${d.status}`)),1)]),_:2},1024)):d.status===2?(f(),V(h,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[g(c(t.$t(`messageBoard.status.${d.status}`)),1)]),_:2},1024)):(f(),V(h,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>[g("unknown")]),_:1}))]),_:1},8,["label"]),e($,{label:t.$t("table.action")},{default:a(({row:d})=>[e(z,{type:"primary",disabled:m(C)("messageBoard:update"),size:"small",link:"",onClick:()=>F(d.id)},{default:a(()=>[g(c(t.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(j,{title:t.$t("confirmDelete"),onConfirm:()=>Y([d.id])},{reference:a(()=>[e(z,{type:"primary",disabled:m(C)("messageBoard:delete"),size:"small",link:""},{default:a(()=>[g(c(t.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ae,r.value]]),e(ee,{currentPage:D.value,"onUpdate:currentPage":n[4]||(n[4]=d=>D.value=d),pageSize:y.value,"onUpdate:pageSize":n[5]||(n[5]=d=>y.value=d),total:o.value,"page-sizes":m(fe),layout:m(ge),small:"",background:"",class:"px-3 py-2 justify-end",onSizeChange:n[6]||(n[6]=()=>B()),onCurrentChange:n[7]||(n[7]=()=>B())},null,8,["currentPage","pageSize","total","page-sizes","layout"])]),e(De,{modelValue:u.value,"onUpdate:modelValue":n[8]||(n[8]=d=>u.value=d),"bean-id":v.value,"bean-ids":I.value,onFinished:B},null,8,["modelValue","bean-id","bean-ids"])])}}});export{Ye as default};
