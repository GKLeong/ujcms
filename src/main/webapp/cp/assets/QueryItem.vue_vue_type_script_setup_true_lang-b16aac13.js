import{al as T,an as M,d as I,p as U,r as w,v as x,a as g,c as v,I as $,h as _,w as b,i as a,aK as z,k as O,t as q,j as Q,a7 as j,a8 as B,u as D,X as R,aL as G,aM as K,l as X,aN as H,aO as W,a4 as Y,aP as Z,e as h,aQ as P,aR as ee}from"./index-6c60ffba.js";const A="ujcms_column_settings";function te(){const t=localStorage.getItem(A);return t?JSON.parse(t):{}}const N=T({}),C=T(te());function le(){localStorage.setItem(A,JSON.stringify(C))}const ne=t=>(N[t]||(N[t]=[]),M(N,t)),F=(t,d)=>{for(let l=0,s=t.length;l<s;)d.findIndex(m=>m.title===t[l].title)===-1?(t.splice(l,1),s-=1):l+=1;return d.forEach(l=>{t.findIndex(s=>s.title===l.title)===-1&&t.push({...l})}),t},ae=(t,d)=>{N[t]=d,C[t]||(C[t]=[]);const l=C[t];F(l,d)},J=t=>(C[t]||(C[t]=[]),M(C,t)),oe={class:"inline-flex align-middle"},se=["divided"],ce=I({__name:"ColumnSetting",props:{name:{type:String,required:!0}},setup(t){const d=t,{name:l}=U(d),s=J(l.value),m=ne(l.value),i=w(!1);x(s,()=>le(),{deep:!0});const k=()=>{s.value=F([],m.value)};return(u,p)=>{const r=g("el-icon"),V=g("el-tooltip"),e=g("el-button"),n=g("el-checkbox"),c=g("el-drawer");return v(),$("div",oe,[_(V,{content:u.$t("table.columnsSetting"),placement:"top"},{default:b(()=>[_(r,{class:"cursor-pointer text-lg text-gray-regular",onClick:p[0]||(p[0]=f=>i.value=!0)},{default:b(()=>[_(a(z))]),_:1})]),_:1},8,["content"]),_(c,{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=f=>i.value=f),title:u.$t("table.columnsSetting"),size:280},{default:b(()=>[_(e,{onClick:k,class:"mb-1",round:""},{default:b(()=>[O(q(u.$t("reset")),1)]),_:1}),Q("ul",null,[(v(!0),$(j,null,B(a(s),(f,o)=>(v(),$("li",{key:f.title,divided:o===0},[_(n,{modelValue:f.display,"onUpdate:modelValue":E=>f.display=E},{default:b(()=>[O(q(f.title),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],8,se))),128))])]),_:1},8,["modelValue","title"])])}}}),me=I({name:"ColumnList",props:{name:{type:String,required:!0}},setup(t,{slots:d}){var r,V;const{name:l}=U(t),{t:s}=D(),m=(V=(r=d.default)==null?void 0:r.call(d))!=null?V:[],i=e=>(e==null?void 0:e.type)==="selection"?s("table.selection"):e==null?void 0:e.label,k=m.map(e=>{var n;return{title:i(e.props),display:((n=e.props)==null?void 0:n.display)!=="none"}});ae(l.value,k);const u=J(l.value);return{columns:R(()=>m.filter(e=>{const n=u.value.find(c=>i(e.props)===c.title);return!n||n.display}).map(e=>({...e,key:i(e.props)})).sort((e,n)=>{let c=u.value.findIndex(o=>o.title===i(e));c<0&&(c=m.findIndex(o=>i(o)===i(e)));let f=u.value.findIndex(o=>o.title===i(n));return f<0&&(f=m.findIndex(o=>i(o)===i(n))),c-f}))}},render(){return this.columns}}),ue=I({name:"QueryInput",props:{inputs:{type:Array,required:!0},name:{type:String,required:!0}},setup(t){const{inputs:d,name:l}=U(t);return()=>d.value.find(s=>s.props.name===l.value)}}),re={class:"flex"},ie={class:"space-y-1"},fe=I({__name:"QueryForm",props:{params:{type:Object,required:!0}},emits:{search:null,reset:null},setup(t){const d=t,{params:l}=U(d),s=G();W("params",l);const m=w([]),i=R(()=>{var e,n;return(n=(e=s.default)==null?void 0:e.call(s))!=null?n:[]});m.value=i.value.map(e=>{var n,c;return{label:(n=e.props)==null?void 0:n.label,name:(c=e.props)==null?void 0:c.name}});const[k]=m.value,u=w([k.name]),p=R(()=>m.value.filter(e=>!u.value.includes(e.name))),r=()=>{Object.keys(l.value).forEach(e=>{!u.value.includes(e)&&u.value.findIndex(n=>n.split(",").includes(e))===-1&&delete l.value[e]})},V=e=>{if(e===0){const[n]=p.value;u.value[u.value.length]=n.name}else u.value.splice(e,1),r()};return(e,n)=>{const c=g("el-button"),f=g("el-option"),o=g("el-select"),E=g("el-button-group");return v(),$("form",re,[Q("div",ie,[(v(!0),$(j,null,B(u.value,(L,S)=>(v(),$("div",{key:L,class:"flex"},[_(c,{icon:S==0?a(Y):a(Z),onClick:y=>V(S),disabled:S<=0&&a(p).length<=0,circle:""},null,8,["icon","onClick","disabled"]),_(o,{modelValue:u.value[S],"onUpdate:modelValue":y=>u.value[S]=y,onChange:n[0]||(n[0]=y=>r()),class:"w-36"},{default:b(()=>[(v(!0),$(j,null,B(m.value.filter(y=>y.name===u.value[S]||a(p).includes(y)),y=>(v(),h(f,{key:y.name,label:y.label,value:y.name},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),_(ue,{inputs:a(i),name:u.value[S]},null,8,["inputs","name"])]))),128))]),Q("div",null,[_(E,{class:"ml-2"},{default:b(()=>[_(c,{"native-type":"submit",icon:a(K),onClick:n[1]||(n[1]=X(L=>e.$emit("search"),["prevent"]))},{default:b(()=>[O(q(e.$t("search")),1)]),_:1},8,["icon"]),_(c,{icon:a(H),onClick:n[2]||(n[2]=L=>e.$emit("reset"))},{default:b(()=>[O(q(e.$t("reset")),1)]),_:1},8,["icon"])]),_:1})])])}}}),de={key:0,class:"inline-block"},ve=I({__name:"QueryItem",props:{label:{type:String,required:!0},name:{type:String,required:!0},type:{type:String},options:{type:Object}},setup(t){const d=t,l=P("params"),{name:s}=U(d),[m,i]=s.value.split(","),k=w(m),u=w(i);return(p,r)=>{const V=g("el-input-number"),e=g("el-date-picker"),n=g("el-option"),c=g("el-select"),f=g("el-input");return ee(p.$slots,"default",{},()=>[t.type==="number"?(v(),$("div",de,[_(V,{modelValue:a(l)[k.value],"onUpdate:modelValue":r[0]||(r[0]=o=>a(l)[k.value]=o),placeholder:p.$t("begin.number"),class:"w-48"},null,8,["modelValue","placeholder"]),_(V,{modelValue:a(l)[u.value],"onUpdate:modelValue":r[1]||(r[1]=o=>a(l)[u.value]=o),placeholder:p.$t("end.number"),class:"w-48"},null,8,["modelValue","placeholder"])])):t.type==="date"?(v(),h(e,{key:1,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[2]||(r[2]=o=>a(l)[a(s)]=o),type:"daterange","start-placeholder":p.$t("begin.date"),"end-placeholder":p.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.type==="datetime"?(v(),h(e,{key:2,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[3]||(r[3]=o=>a(l)[a(s)]=o),type:"datetimerange","start-placeholder":p.$t("begin.date"),"end-placeholder":p.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.options?(v(),h(c,{key:3,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[4]||(r[4]=o=>a(l)[a(s)]=o),multiple:"",class:"w-96"},{default:b(()=>[(v(!0),$(j,null,B(t.options,o=>(v(),h(n,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(v(),h(f,{key:4,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[5]||(r[5]=o=>a(l)[a(s)]=o),class:"w-96"},null,8,["modelValue"]))])}}});export{fe as _,ve as a,ce as b,me as c};
