import{d as P,u as T,U as p,V as $,r as C,o as O,a as b,c as r,I as c,h as t,w as s,j as e,t as a,i as m,W as q,X as z,J as B,Y as H,Z as S,k as _,$ as g,a0 as I}from"./index-8dd878a9.js";import{d as R,q as A,a as E,b as L}from"./stat-6fd59b10.js";const N={class:"p-3 app-block"},U={class:"text-sm text-gray-secondary"},W={class:"flex items-end justify-between mt-1"},F={class:"text-3xl text-primary"},G={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},J={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},X={class:"p-3 app-block"},Z={class:"text-sm text-gray-secondary"},K={class:"flex items-end justify-between mt-1"},Q={class:"text-3xl text-primary"},tt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},et={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},st={class:"p-3 app-block"},at={class:"text-sm text-gray-secondary"},nt={class:"flex items-end justify-between mt-1"},ot={class:"text-3xl text-primary"},it={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},lt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},dt={class:"p-3 app-block"},ut={class:"text-sm text-gray-secondary"},rt={class:"flex items-end justify-between mt-1"},ct={class:"text-3xl text-primary"},vt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},_t={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},pt={class:"px-3 py-5 mt-3 app-block"},ft={class:"flex p-3 mt-3 justify-evenly app-block"},yt={class:"h-64 w-60 text-primary"},ht={class:"mt-2 text-center"},mt={class:"flex items-center justify-center mt-2"},xt={class:"text-3xl"},gt={key:0},Ct={key:1},bt={class:"mt-4 space-y-2 text-sm"},wt={key:0},kt={key:1},$t={key:0},St={key:1},Vt={key:0},jt={key:1},Yt={class:"h-64 w-60 text-gray-secondary"},Dt={class:"mt-2 text-center"},Mt={class:"flex items-center justify-center mt-2"},Pt={class:"text-3xl"},Tt={key:0},Ot={key:1},qt={class:"mt-4 space-y-2 text-sm"},zt={key:0},Bt={key:1},Ht={key:0},It={key:1},Rt={key:0},At={key:1},Et={class:"p-3 mt-3 app-block"},Wt=P({__name:"HomePage",setup(Lt){const{t:x,n:V}=T();p.extend(R);const w=$(),j=async()=>{const o=await A({begin:p().startOf("day").subtract(1,"day").format(),end:p().endOf("day").format()}),h={tooltip:{trigger:"axis"},legend:{data:[x("visitTrend.yesterdayPv"),x("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:x("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:o.filter(i=>p(i.date)<p().startOf("day")).map(i=>i.pvCount)},{name:x("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:o.filter(i=>p(i.date)>=p().startOf("day")).map(i=>i.pvCount)}]},f=w.value;if(f==null)return;let n=g.getInstanceByDom(f);n==null&&(n=g.init(f)),n.setOption(h),window.addEventListener("resize",function(){n&&n.resize()})},k=$(),Y=async()=>{const o=await E({begin:p().subtract(30,"day").format("YYYY-MM-DD"),end:p().format("YYYY-MM-DD")}),h=o.reduce((l,v)=>l+v.pvCount,0),f={title:{text:x("menu.stat.visitRegion"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:l=>V(l*100/h,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:x("menu.stat.visitRegion"),type:"pie",radius:"72%",center:["40%","56%"],data:o.map(l=>({value:l.pvCount,name:l.name}))}]},n=k.value;if(n==null)return;let i=g.getInstanceByDom(n);i==null&&(i=g.init(n)),i.setOption(f),window.addEventListener("resize",function(){i&&i.resize()})},d=C({}),u=C({}),D=async()=>{const o=await L({begin:p().subtract(30,"day").format("YYYY-MM-DD"),end:p().format("YYYY-MM-DD")});d.value=o.newVisitor,u.value=o.oldVisitor;const h=d.value.uvCount+u.value.uvCount;h>0?(d.value.proportion=d.value.uvCount*100/h,u.value.proportion=u.value.uvCount*100/h):(d.value.proportion=50,u.value.proportion=50)},y=C({}),M=async()=>{y.value=await I()};return O(async()=>{j(),Y(),D(),M()}),(o,h)=>{const f=b("el-icon"),n=b("el-col"),i=b("el-row");return r(),c("div",null,[t(i,{gutter:12},{default:s(()=>[t(n,{span:6},{default:s(()=>{var l,v;return[e("div",N,[e("div",U,a(o.$t("contentStat.article")),1),e("div",W,[e("div",F,a((l=y.value.article)==null?void 0:l.total),1),e("div",G,[t(f,null,{default:s(()=>[t(m(q))]),_:1})])]),e("div",J,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((v=y.value.article)==null?void 0:v.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var l,v;return[e("div",X,[e("div",Z,a(o.$t("contentStat.channel")),1),e("div",K,[e("div",Q,a((l=y.value.channel)==null?void 0:l.total),1),e("div",tt,[t(f,null,{default:s(()=>[t(m(z))]),_:1})])]),e("div",et,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((v=y.value.channel)==null?void 0:v.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var l,v;return[e("div",st,[e("div",at,a(o.$t("contentStat.user")),1),e("div",nt,[e("div",ot,a((l=y.value.user)==null?void 0:l.total),1),e("div",it,[t(f,null,{default:s(()=>[t(m(B))]),_:1})])]),e("div",lt,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((v=y.value.user)==null?void 0:v.last7day),1)])])]}),_:1}),t(n,{span:6},{default:s(()=>{var l,v;return[e("div",dt,[e("div",ut,a(o.$t("contentStat.attachment")),1),e("div",rt,[e("div",ct,a((l=y.value.attachment)==null?void 0:l.total),1),e("div",vt,[t(f,null,{default:s(()=>[t(m(H))]),_:1})])]),e("div",_t,[e("div",null,a(o.$t("contentStat.last7day")),1),e("div",null,a((v=y.value.attachment)==null?void 0:v.last7day),1)])])]}),_:1})]),_:1}),e("div",pt,[e("div",{ref_key:"trendChart",ref:w,class:"h-64"},null,512)]),t(i,{gutter:12},{default:s(()=>[t(n,{span:12},{default:s(()=>{var l,v;return[e("div",ft,[e("div",yt,[e("div",ht,a(o.$t("visitVisitor.newVisitor")),1),e("div",mt,[t(f,{class:"text-5xl"},{default:s(()=>[t(m(S))]),_:1}),e("span",xt,[d.value.uvCount>0?(r(),c("span",gt,a(o.$n((l=d.value.proportion)!=null?l:0,"decimal")),1)):(r(),c("span",Ct,"-")),_("% ")])]),e("div",bt,[t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visitVisitor.pv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[_(a(d.value.pvCount),1)]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visitVisitor.uv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[_(a(d.value.uvCount),1)]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.bounceRate")),1)]),_:1}),t(n,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),c("span",wt,a(o.$n(d.value.bounceCount*100/d.value.uvCount,"decimal"))+"%",1)):(r(),c("span",kt,"-"))]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.averageDuration")),1)]),_:1}),t(n,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),c("span",$t,a(m(p).duration(d.value.duration/d.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),c("span",St,"-"))]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.averagePv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),c("span",Vt,a(o.$n(d.value.pvCount/d.value.uvCount,"decimal")),1)):(r(),c("span",jt,"-"))]),_:1})]),_:1})])]),e("div",Yt,[e("div",Dt,a(o.$t("visitVisitor.oldVisitor")),1),e("div",Mt,[t(f,{class:"text-5xl"},{default:s(()=>[t(m(S))]),_:1}),e("span",Pt,[u.value.uvCount>0?(r(),c("span",Tt,a(o.$n((v=u.value.proportion)!=null?v:0,"decimal")),1)):(r(),c("span",Ot,"-")),_("% ")])]),e("div",qt,[t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visitVisitor.pv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[_(a(u.value.pvCount),1)]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visitVisitor.uv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[_(a(u.value.uvCount),1)]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.bounceRate")),1)]),_:1}),t(n,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),c("span",zt,a(o.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(r(),c("span",Bt,"-"))]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.averageDuration")),1)]),_:1}),t(n,{span:12},{default:s(()=>[d.value.uvCount>0?(r(),c("span",Ht,a(m(p).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(r(),c("span",It,"-"))]),_:1})]),_:1}),t(i,{gutter:24},{default:s(()=>[t(n,{span:12,class:"text-right"},{default:s(()=>[_(a(o.$t("visit.averagePv")),1)]),_:1}),t(n,{span:12},{default:s(()=>[u.value.uvCount>0?(r(),c("span",Rt,a(o.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(r(),c("span",At,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(n,{span:12},{default:s(()=>[e("div",Et,[e("div",{ref_key:"provinceChart",ref:k,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{Wt as default};
