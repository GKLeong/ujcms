import{c7 as L,co as Q,d as I,p as U,r as w,v as M,a as g,c as f,I as V,h as _,w as b,i as s,cR as z,k as O,t as q,j as E,ac as j,ad as B,u as D,a1 as R,cx as G,c4 as H,aa as K,aN as W,e as h,cS as X,l as Y,cT as Z,aP as P,b1 as ee}from"./index-0b297134.js";const x="ujcms_column_settings";function te(){const t=localStorage.getItem(x);return t?JSON.parse(t):{}}const N=L({}),$=L(te());function le(){localStorage.setItem(x,JSON.stringify($))}const ne=t=>(N[t]||(N[t]=[]),Q(N,t)),A=(t,d)=>{for(let l=0,o=t.length;l<o;)d.findIndex(m=>m.title===t[l].title)===-1?(t.splice(l,1),o-=1):l+=1;return d.forEach(l=>{t.findIndex(o=>o.title===l.title)===-1&&t.push({...l})}),t},ae=(t,d)=>{N[t]=d,$[t]||($[t]=[]);const l=$[t];A(l,d)},F=t=>($[t]||($[t]=[]),Q($,t)),oe={class:"inline-flex align-middle"},se=["divided"],pe=I({__name:"ColumnSetting",props:{name:{type:String,required:!0}},setup(t){const d=t,{name:l}=U(d),o=F(l.value),m=ne(l.value),i=w(!1);M(o,()=>le(),{deep:!0});const k=()=>{o.value=A([],m.value)};return(u,c)=>{const r=g("el-icon"),y=g("el-tooltip"),e=g("el-button"),n=g("el-checkbox"),p=g("el-drawer");return f(),V("div",oe,[_(y,{content:u.$t("table.columnsSetting"),placement:"top"},{default:b(()=>[_(r,{class:"cursor-pointer text-lg text-gray-regular",onClick:c[0]||(c[0]=()=>i.value=!0)},{default:b(()=>[_(s(z))]),_:1})]),_:1},8,["content"]),_(p,{modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=v=>i.value=v),title:u.$t("table.columnsSetting"),size:375},{default:b(()=>[_(e,{class:"mb-1",round:"",onClick:k},{default:b(()=>[O(q(u.$t("reset")),1)]),_:1}),E("ul",null,[(f(!0),V(j,null,B(s(o),(v,a)=>(f(),V("li",{key:v.title,divided:a===0},[_(n,{modelValue:v.display,"onUpdate:modelValue":T=>v.display=T},{default:b(()=>[O(q(v.title),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],8,se))),128))])]),_:1},8,["modelValue","title"])])}}}),me=I({name:"ColumnList",props:{name:{type:String,required:!0}},setup(t,{slots:d}){var r,y;const{name:l}=U(t),{t:o}=D(),m=(y=(r=d.default)==null?void 0:r.call(d))!=null?y:[],i=e=>(e==null?void 0:e.type)==="selection"?o("table.selection"):e==null?void 0:e.label,k=m.map(e=>{var n;return{title:i(e.props),display:((n=e.props)==null?void 0:n.display)!=="none"}});ae(l.value,k);const u=F(l.value);return{columns:R(()=>m.filter(e=>{const n=u.value.find(p=>i(e.props)===p.title);return!n||n.display}).map(e=>({...e,key:i(e.props)})).sort((e,n)=>{let p=u.value.findIndex(a=>a.title===i(e));p<0&&(p=m.findIndex(a=>i(a)===i(e)));let v=u.value.findIndex(a=>a.title===i(n));return v<0&&(v=m.findIndex(a=>i(a)===i(n))),p-v}))}},render(){return this.columns}}),ue=I({name:"QueryInput",props:{inputs:{type:Array,required:!0},name:{type:String,required:!0}},setup(t){const{inputs:d,name:l}=U(t);return()=>d.value.find(o=>o.props.name===l.value)}}),re={class:"flex"},ie={class:"space-y-1"},fe=I({__name:"QueryForm",props:{params:{type:Object,required:!0}},emits:{search:null,reset:null},setup(t){const d=t,{params:l}=U(d),o=G();H("params",l);const m=w([]),i=R(()=>{var e,n;return(n=(e=o.default)==null?void 0:e.call(o))!=null?n:[]});m.value=i.value.map(e=>{var n,p;return{label:(n=e.props)==null?void 0:n.label,name:(p=e.props)==null?void 0:p.name}});const[k]=m.value,u=w([k.name]),c=R(()=>m.value.filter(e=>!u.value.includes(e.name))),r=()=>{Object.keys(l.value).forEach(e=>{!u.value.includes(e)&&u.value.findIndex(n=>n.split(",").includes(e))===-1&&delete l.value[e]})},y=e=>{if(e===0){const[n]=c.value;u.value[u.value.length]=n.name}else u.value.splice(e,1),r()};return(e,n)=>{const p=g("el-button"),v=g("el-option"),a=g("el-select"),T=g("el-button-group");return f(),V("form",re,[E("div",ie,[(f(!0),V(j,null,B(u.value,(J,C)=>(f(),V("div",{key:J,class:"flex"},[_(p,{icon:C==0?s(K):s(W),disabled:C<=0&&c.value.length<=0,circle:"",onClick:()=>y(C)},null,8,["icon","disabled","onClick"]),_(a,{modelValue:u.value[C],"onUpdate:modelValue":S=>u.value[C]=S,class:"w-36",onChange:n[0]||(n[0]=()=>r())},{default:b(()=>[(f(!0),V(j,null,B(m.value.filter(S=>S.name===u.value[C]||c.value.includes(S)),S=>(f(),h(v,{key:S.name,label:S.label,value:S.name},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),_(ue,{inputs:i.value,name:u.value[C]},null,8,["inputs","name"])]))),128))]),E("div",null,[_(T,{class:"ml-2"},{default:b(()=>[_(p,{"native-type":"submit",icon:s(X),onClick:n[1]||(n[1]=Y(()=>e.$emit("search"),["prevent"]))},{default:b(()=>[O(q(e.$t("search")),1)]),_:1},8,["icon"]),_(p,{icon:s(Z),onClick:n[2]||(n[2]=()=>e.$emit("reset"))},{default:b(()=>[O(q(e.$t("reset")),1)]),_:1},8,["icon"])]),_:1})])])}}}),de={key:0,class:"inline-block"},ve=I({__name:"QueryItem",props:{label:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,default:null},options:{type:Object,default:null}},setup(t){const d=t,l=P("params"),{name:o}=U(d),[m,i]=o.value.split(","),k=w(m),u=w(i);return(c,r)=>{const y=g("el-input-number"),e=g("el-date-picker"),n=g("el-option"),p=g("el-select"),v=g("el-input");return ee(c.$slots,"default",{},()=>[t.type==="number"?(f(),V("div",de,[_(y,{modelValue:s(l)[k.value],"onUpdate:modelValue":r[0]||(r[0]=a=>s(l)[k.value]=a),placeholder:c.$t("begin.number"),class:"w-48"},null,8,["modelValue","placeholder"]),_(y,{modelValue:s(l)[u.value],"onUpdate:modelValue":r[1]||(r[1]=a=>s(l)[u.value]=a),placeholder:c.$t("end.number"),class:"w-48"},null,8,["modelValue","placeholder"])])):t.type==="date"?(f(),h(e,{key:1,modelValue:s(l)[s(o)],"onUpdate:modelValue":r[2]||(r[2]=a=>s(l)[s(o)]=a),type:"daterange","start-placeholder":c.$t("begin.date"),"end-placeholder":c.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.type==="datetime"?(f(),h(e,{key:2,modelValue:s(l)[s(o)],"onUpdate:modelValue":r[3]||(r[3]=a=>s(l)[s(o)]=a),type:"datetimerange","start-placeholder":c.$t("begin.date"),"end-placeholder":c.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.options?(f(),h(p,{key:3,modelValue:s(l)[s(o)],"onUpdate:modelValue":r[4]||(r[4]=a=>s(l)[s(o)]=a),multiple:"",class:"w-96"},{default:b(()=>[(f(!0),V(j,null,B(t.options,a=>(f(),h(n,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(f(),h(v,{key:4,modelValue:s(l)[s(o)],"onUpdate:modelValue":r[5]||(r[5]=a=>s(l)[s(o)]=a),class:"w-96"},null,8,["modelValue"]))])}}});export{fe as _,ve as a,pe as b,me as c};
