var ue=Object.defineProperty,oe=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var W=(g,l,s)=>l in g?ue(g,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):g[l]=s,T=(g,l)=>{for(var s in l||(l={}))re.call(l,s)&&W(g,s,l[s]);if(J)for(var s of J(l))ie.call(l,s)&&W(g,s,l[s]);return g},N=(g,l)=>oe(g,de(l));import{g as K,I as y,j as v,o as b,k as _,w as a,l as e,x as h,P as f,A as m,y as D,m as i,u as x,i as me,M as ee,N as ae,q as O,an as pe,O as le,f as X,Q as U,K as R,F as fe,C as ve}from"./vendor.3651bf9f.js";import{g as ce,u as be}from"./config.d674241a.js";import{D as ye,E as _e,F as Z,G as ge,H as ke,I as $e}from"./content.773ecdb4.js";import{p as S,d as he,e as Ve,t as we,r as De,n as Ce}from"./index.53bc5a6e.js";import{_ as E}from"./LabelTip.06c71e40.js";import{a as Se,c as Ie,u as qe,b as te,e as Ue}from"./system.6c199ff9.js";import{_ as ze,a as Be,b as He,c as Pe}from"./QueryItem.794d4c55.js";import{_ as Ae}from"./DialogForm.3aeea6b8.js";const Fe={class:"whitespace-pre-wrap"},Re={name:"TaskForm"},Ee=K(N(T({},Re),{props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(g){const l=y({});return(s,t)=>{const k=v("el-input"),u=v("el-form-item"),c=v("el-col"),z=v("el-date-picker"),M=v("el-option"),B=v("el-select"),C=v("el-tag"),H=v("el-row");return b(),_(Ae,{name:s.$t("menu.system.task"),queryBean:i(Se),createBean:i(Ie),updateBean:i(qe),deleteBean:i(te),beanId:g.beanId,beanIds:g.beanIds,initValues:()=>({user:{}}),toValues:d=>T({},d),disableEdit:()=>!0,addable:!1,perms:"task",values:l.value,"onUpdate:values":t[7]||(t[7]=d=>l.value=d),"model-value":g.modelValue,"onUpdate:modelValue":t[8]||(t[8]=d=>s.$emit("update:modelValue",d)),onFinished:t[9]||(t[9]=d=>s.$emit("finished")),large:""},{default:a(({})=>[e(H,null,{default:a(()=>[e(c,{span:12},{default:a(()=>[e(u,{prop:"name",label:s.$t("task.name")},{default:a(()=>[e(k,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=d=>l.value.name=d)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"user.username",label:s.$t("task.user")},{default:a(()=>[e(k,{modelValue:l.value.user.username,"onUpdate:modelValue":t[1]||(t[1]=d=>l.value.user.username=d)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"beginDate",label:s.$t("task.beginDate")},{default:a(()=>[e(z,{modelValue:l.value.beginDate,"onUpdate:modelValue":t[2]||(t[2]=d=>l.value.beginDate=d),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"endDate",label:s.$t("task.endDate")},{default:a(()=>[e(z,{modelValue:l.value.endDate,"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.endDate=d),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"current",label:s.$t("task.current")},{default:a(()=>[e(k,{modelValue:l.value.current,"onUpdate:modelValue":t[4]||(t[4]=d=>l.value.current=d)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"processedIn",label:s.$t("task.processedIn")},{default:a(()=>[e(k,{modelValue:l.value.processedIn,"onUpdate:modelValue":t[5]||(t[5]=d=>l.value.processedIn=d)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{prop:"type",label:s.$t("task.type")},{default:a(()=>[l.value.type?(b(),_(B,{key:0,modelValue:l.value.type,"onUpdate:modelValue":t[6]||(t[6]=d=>l.value.type=d)},{default:a(()=>[e(M,{value:l.value.type,label:s.$t(`task.type.${l.value.type}`)},null,8,["value","label"])]),_:1},8,["modelValue"])):h("",!0)]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(u,{label:s.$t("task.status")},{default:a(()=>[l.value.status===0?(b(),_(C,{key:0,type:"info"},{default:a(()=>[f(m(s.$t(`task.status.${l.value.status}`)),1)]),_:1})):h("",!0),l.value.status===1?(b(),_(C,{key:1},{default:a(()=>[f(m(s.$t(`task.status.${l.value.status}`)),1)]),_:1})):h("",!0),l.value.status===2?(b(),_(C,{key:2,type:"danger"},{default:a(()=>[f(m(s.$t(`task.status.${l.value.status}`)),1)]),_:1})):h("",!0),l.value.status===3?(b(),_(C,{key:3,type:"warning"},{default:a(()=>[f(m(s.$t(`task.status.${l.value.status}`)),1)]),_:1})):h("",!0),l.value.status===4?(b(),_(C,{key:4,type:"success"},{default:a(()=>[f(m(s.$t(`task.status.${l.value.status}`)),1)]),_:1})):h("",!0)]),_:1},8,["label"])]),_:1}),l.value.errorInfo?(b(),_(c,{key:0,span:24},{default:a(()=>[e(u,{label:s.$t("task.errorInfo")},{default:a(()=>[D("pre",null,[D("code",Fe,m(l.value.errorInfo),1)])]),_:1},8,["label"])]),_:1})):h("",!0)]),_:1})]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","initValues","toValues","disableEdit","values","model-value"])}}})),Me={class:"mb-3"},Te={class:"app-block mt-3"},Ye={name:"TaskList"},Le=K(N(T({},Ye),{setup(g,{expose:l}){const{t:s}=x(),t=y({}),k=y(),u=y(1),c=y(10),z=y(0),M=y(),B=y([]),C=y([]),H=y(!1),d=y(!1),j=y(),Q=me(()=>B.value.map(n=>n.id)),r=async()=>{H.value=!0;try{const{content:n,totalElements:p}=await Ue(N(T({},we(t.value)),{Q_OrderBy:k.value,page:u.value,pageSize:c.value}));B.value=n,z.value=p}finally{H.value=!1}};ee(r);const V=({column:n,prop:p,order:P})=>{var A;p?k.value=((A=n.sortBy)!=null?A:p)+(P==="descending"?"_desc":""):k.value=void 0,r()},I=()=>r(),q=()=>{M.value.clearSort(),De(t.value),k.value=void 0,r()},Y=n=>{j.value=n,d.value=!0},L=async n=>{await te(n),r(),U.success(s("success"))};return l({fetchData:r}),(n,p)=>{const P=v("el-button"),A=v("el-popconfirm"),w=v("el-table-column"),F=v("el-tag"),$=v("el-table"),se=v("el-pagination"),ne=ae("loading");return b(),O("div",null,[D("div",Me,[e(i(Be),{params:t.value,onSearch:I,onReset:q},{default:a(()=>[e(i(ze),{label:n.$t("task.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),D("div",null,[e(A,{title:n.$t("confirmDelete"),onConfirm:p[0]||(p[0]=o=>L(C.value.map(G=>G.id)))},{reference:a(()=>[e(P,{disabled:C.value.length<=0||i(S)("task:delete"),icon:i(pe)},{default:a(()=>[f(m(n.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(i(He),{name:"task",class:"ml-2"})]),D("div",Te,[le((b(),_($,{ref_key:"table",ref:M,data:B.value,onSelectionChange:p[1]||(p[1]=o=>C.value=o),onRowDblclick:p[2]||(p[2]=o=>Y(o.id)),onSortChange:V},{default:a(()=>[e(i(Pe),{name:"task"},{default:a(()=>[e(w,{type:"selection",width:"45"}),e(w,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(w,{property:"name",label:n.$t("task.name"),sortable:"custom","min-width":"150","show-overflow-tooltip":""},null,8,["label"]),e(w,{property:"beginDate",label:n.$t("task.beginDate"),sortable:"custom",width:"170"},{default:a(({row:o})=>[f(m(i(X)(o.beginDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(w,{property:"endDate",label:n.$t("task.endDate"),sortable:"custom",width:"170",display:"none"},{default:a(({row:o})=>[f(m(i(X)(o.endDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(w,{property:"current",label:n.$t("task.current"),"min-width":"70",align:"right"},null,8,["label"]),e(w,{property:"processedIn",label:n.$t("task.processedIn"),"min-width":"70",align:"right"},null,8,["label"]),e(w,{property:"user.username",label:n.$t("task.user"),"sort-by":"user-username",sortable:"custom","min-width":"80",align:"right"},null,8,["label"]),e(w,{property:"status",label:n.$t("task.status"),sortable:"custom",width:"80","show-overflow-tooltip":""},{default:a(({row:o})=>[o.status===0?(b(),_(F,{key:0,type:"info",size:"small"},{default:a(()=>[f(m(n.$t(`task.status.${o.status}`)),1)]),_:2},1024)):h("",!0),o.status===1?(b(),_(F,{key:1,size:"small"},{default:a(()=>[f(m(n.$t(`task.status.${o.status}`)),1)]),_:2},1024)):h("",!0),o.status===2?(b(),_(F,{key:2,type:"danger",size:"small"},{default:a(()=>[f(m(n.$t(`task.status.${o.status}`)),1)]),_:2},1024)):h("",!0),o.status===3?(b(),_(F,{key:3,type:"warning",size:"small"},{default:a(()=>[f(m(n.$t(`task.status.${o.status}`)),1)]),_:2},1024)):h("",!0),o.status===4?(b(),_(F,{key:4,type:"success",size:"small"},{default:a(()=>[f(m(n.$t(`task.status.${o.status}`)),1)]),_:2},1024)):h("",!0)]),_:1},8,["label"]),e(w,{label:n.$t("table.action")},{default:a(({row:o})=>[e(P,{type:"primary",disabled:i(S)("task:show"),onClick:G=>Y(o.id),size:"small",link:""},{default:a(()=>[f(m(n.$t("detail")),1)]),_:2},1032,["disabled","onClick"]),e(A,{title:n.$t("confirmDelete"),onConfirm:G=>L([o.id])},{reference:a(()=>[e(P,{type:"primary",disabled:i(S)("task:delete"),size:"small",link:""},{default:a(()=>[f(m(n.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ne,H.value]]),e(se,{currentPage:u.value,"onUpdate:currentPage":p[3]||(p[3]=o=>u.value=o),pageSize:c.value,"onUpdate:pageSize":p[4]||(p[4]=o=>c.value=o),total:z.value,"page-sizes":i(he),layout:i(Ve),onSizeChange:p[5]||(p[5]=o=>r()),onCurrentChange:p[6]||(p[6]=o=>r()),small:"",background:"",class:"px-3 py-2 justify-end"},null,8,["currentPage","pageSize","total","page-sizes","layout"])]),e(Ee,{modelValue:d.value,"onUpdate:modelValue":p[7]||(p[7]=o=>d.value=o),beanId:j.value,beanIds:i(Q),onFinished:r},null,8,["modelValue","beanId","beanIds"])])}}})),Ne={class:"p-3 app-block"},je=D("span",{class:"mx-2"},"|",-1),Qe={class:"mt-3 p-3 app-block"},Ge={class:"pb-2 border-b text-gray-primary"},Oe=f(".html"),Ke=f(".html"),Je={class:"mt-3 p-3 app-block"},We={class:"text-gray-primary"},Xe={name:"GeneratorForm"},oa=K(N(T({},Xe),{setup(g){const{t:l}=x(),s=y(),t=y({}),k=y(!1),u=y(!1),c=y(),z=async()=>{t.value=await ce()};ee(async()=>{k.value=!0;try{await z()}finally{k.value=!1}});const M=async()=>{u.value=!0;try{await ye(),await c.value.fetchData(),U.success(l("success"))}finally{u.value=!1}},B=async()=>{u.value=!0;try{await _e(),await c.value.fetchData(),U.success(l("success"))}finally{u.value=!1}},C=async()=>{u.value=!0;try{await Z(),await c.value.fetchData(),U.success(l("success"))}finally{u.value=!1}},H=async()=>{u.value=!0;try{await ge(),U.success(l("success"))}finally{u.value=!1}},d=async()=>{u.value=!0;try{await ke(),await c.value.fetchData(),U.success(l("success"))}finally{u.value=!1}},j=async()=>{u.value=!0;try{await $e(),await c.value.fetchData(),U.success(l("success"))}finally{u.value=!1}},Q=()=>{!s.value||s.value.validate(async r=>{if(!!r){k.value=!0;try{await be(t.value),await Z(),await c.value.fetchData(),U.success(l("success"))}finally{k.value=!1}}})};return(r,V)=>{const I=v("el-button"),q=v("el-form-item"),Y=v("el-form"),L=v("el-switch"),n=v("el-col"),p=v("el-input"),P=v("el-option"),A=v("el-select"),w=v("el-row"),F=ae("loading");return b(),O("div",null,[D("div",Ne,[e(Y,{"label-width":"200px"},{default:a(()=>[e(q,null,{label:a(()=>[e(E,{message:"generator.fulltext",help:""})]),default:a(()=>[e(I,{disabled:i(S)("generator:fulltext:reindexAll"),loading:u.value,onClick:R(M,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.fulltext.reindexAll")),1)]),_:1},8,["disabled","loading","onClick"]),i(Ce)("generator:fulltext:reindexSite")?(b(),_(I,{key:0,disabled:i(S)("generator:fulltext:reindexSite"),loading:u.value,onClick:R(B,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.fulltext.reindexSite")),1)]),_:1},8,["disabled","loading","onClick"])):h("",!0)]),_:1}),e(q,null,{label:a(()=>[e(E,{message:"generator.html",help:""})]),default:a(()=>[e(I,{disabled:i(S)("generator:html"),loading:u.value,onClick:R(C,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.html.all")),1)]),_:1},8,["disabled","loading","onClick"]),je,e(I,{disabled:i(S)("generator:html"),loading:u.value,onClick:R(H,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.html.home")),1)]),_:1},8,["disabled","loading","onClick"]),e(I,{disabled:i(S)("generator:html"),loading:u.value,onClick:R(d,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.html.channel")),1)]),_:1},8,["disabled","loading","onClick"]),e(I,{disabled:i(S)("generator:html"),loading:u.value,onClick:R(j,["prevent"]),type:"primary",plain:""},{default:a(()=>[f(m(r.$t("generator.op.html.article")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),D("div",Qe,[D("div",Ge,m(r.$t("site.settings.html")),1),le((b(),_(Y,{class:"mt-3",ref_key:"form",ref:s,model:t.value,disabled:i(S)("siteSettings:html:update"),"label-width":"200px"},{default:a(()=>[e(w,null,{default:a(()=>[e(n,{span:12},{default:a(()=>[e(q,{prop:"enabled",rules:{required:!0,message:()=>r.$t("v.required")}},{label:a(()=>[e(E,{message:"site.html.enabled",help:""})]),default:a(()=>[e(L,{modelValue:t.value.enabled,"onUpdate:modelValue":V[0]||(V[0]=$=>t.value.enabled=$)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(q,{prop:"auto",rules:{required:!0,message:()=>r.$t("v.required")}},{label:a(()=>[e(E,{message:"site.html.auto",help:""})]),default:a(()=>[e(L,{modelValue:t.value.auto,"onUpdate:modelValue":V[1]||(V[1]=$=>t.value.auto=$)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(q,{prop:"channel",rules:{required:!0,message:()=>r.$t("v.required")}},{label:a(()=>[e(E,{message:"site.html.channel",help:""})]),default:a(()=>[e(p,{modelValue:t.value.channel,"onUpdate:modelValue":V[2]||(V[2]=$=>t.value.channel=$),maxlength:"100"},{append:a(()=>[Oe]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(q,{prop:"article",rules:{required:!0,message:()=>r.$t("v.required")}},{label:a(()=>[e(E,{message:"site.html.article",help:""})]),default:a(()=>[e(p,{modelValue:t.value.article,"onUpdate:modelValue":V[3]||(V[3]=$=>t.value.article=$),maxlength:"100"},{append:a(()=>[Ke]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(q,{prop:"listPages",rules:{required:!0,message:()=>r.$t("v.required")}},{label:a(()=>[e(E,{message:"site.html.listPages",help:""})]),default:a(()=>[e(A,{modelValue:t.value.listPages,"onUpdate:modelValue":V[4]||(V[4]=$=>t.value.listPages=$),placeholder:"Select"},{default:a(()=>[(b(),O(fe,null,ve([{label:"1",value:1},{label:"3",value:3},{label:"10",value:10},{label:"100",value:100},{label:"1000",value:1e3},{label:"\u5168\u90E8",value:2147483647}],$=>e(P,{key:$.value,label:$.label,value:$.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1}),D("div",null,[e(I,{disabled:i(S)("siteSettings:html:update"),onClick:R(Q,["prevent"]),type:"primary","native-type":"submit"},{default:a(()=>[f(m(r.$t("submit")),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["model","disabled"])),[[F,k.value]])]),D("div",Je,[D("div",We,m(r.$t("generator.taskList")),1)]),e(Le,{ref_key:"taskListRef",ref:c,class:"mt-3"},null,512)])}}}));export{oa as default};
