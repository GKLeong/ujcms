import{d as R,u as x,U as r,r as B,V as C,o as V,a as p,c as b,I as M,j as s,h as c,w as u,ac as S,ad as z,k as E,t as I,$ as m}from"./index-8dd878a9.js";import{d as P,c as F,a as L}from"./stat-6fd59b10.js";const N={class:"p-3 mt-3 app-block"},$={class:"p-3 mt-3 app-block"},j={class:"p-3 mt-3 app-block"},W=R({__name:"VisitRegion",setup(q){const{t:d,n:v}=x();r.extend(P);const y=B("last30day"),Y=e=>{switch(e){case"today":return r().format("YYYY-MM-DD");case"yesterday":return r().subtract(1,"day").format("YYYY-MM-DD");case"last7day":return r().subtract(6,"day").format("YYYY-MM-DD");case"last30day":return r().subtract(29,"day").format("YYYY-MM-DD");case"lastYear":return r().subtract(1,"year").format("YYYY-MM-DD");default:return}},_=e=>e==="yesterday"?r().subtract(1,"day").format("YYYY-MM-DD"):r().format("YYYY-MM-DD"),g=C(),w=async e=>{const n=await F({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+f.pvCount,0),i={title:{text:d("menu.stat.visitCountry"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitCountry"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:t.pvCount,name:t.name}))}]},o=g.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},h=C(),k=async e=>{const n=await L({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+f.pvCount,0),i={title:{text:d("menu.stat.visitProvince"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitProvince"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:t.pvCount,name:t.name}))}]},o=h.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},D=async e=>{w(e),k(e)};return V(async()=>{D(y.value)}),(e,n)=>{const l=p("el-radio-button"),i=p("el-radio-group"),o=p("el-col"),a=p("el-row");return b(),M("div",null,[s("div",N,[s("div",null,[c(i,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=t=>y.value=t),onChange:n[1]||(n[1]=t=>D(t))},{default:u(()=>[(b(),M(S,null,z(["today","yesterday","last7day","last30day","lastYear","all"],t=>c(l,{key:t,label:t},{default:u(()=>[E(I(e.$t(`visit.${t}`)),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])]),c(a,{gutter:12},{default:u(()=>[c(o,{span:12},{default:u(()=>[s("div",$,[s("div",{ref_key:"countryChartRef",ref:g,class:"h-80"},null,512)])]),_:1}),c(o,{span:12},{default:u(()=>[s("div",j,[s("div",{ref_key:"provinceChartRef",ref:h,class:"h-80"},null,512)])]),_:1})]),_:1})])}}});export{W as default};
